<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stratified · WavKinS.jl</title><meta name="title" content="Stratified · WavKinS.jl"/><meta property="og:title" content="Stratified · WavKinS.jl"/><meta property="twitter:title" content="Stratified · WavKinS.jl"/><meta name="description" content="Documentation for WavKinS.jl."/><meta property="og:description" content="Documentation for WavKinS.jl."/><meta property="twitter:description" content="Documentation for WavKinS.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="WavKinS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">WavKinS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Quick start</span><ul><li><a class="tocitem" href="../quick_start/installation.html">Installing WavKinS</a></li><li><a class="tocitem" href="../quick_start/collisional_integral_tutorial.html">Computing a collisional integral</a></li><li><a class="tocitem" href="../quick_start/running_tutorial.html">Running an example</a></li><li><a class="tocitem" href="../quick_start/diagnostics_tutorial.html">Adding a diagnostic</a></li></ul></li><li><a class="tocitem" href="../basics.html">Basics</a></li><li><span class="tocitem">Physical systems</span><ul><li><a class="tocitem" href="Acoustic.html">Acoustic</a></li><li><a class="tocitem" href="Bogoliubov.html">Bogoliubov</a></li><li><a class="tocitem" href="NLS.html">NLS</a></li><li><a class="tocitem" href="MMT.html">MMT</a></li><li><a class="tocitem" href="Petviashvilli.html">Petviashvilli</a></li><li><a class="tocitem" href="Smoluchowski.html">Smoluchowski</a></li><li class="is-active"><a class="tocitem" href="Stratified.html">Stratified</a><ul class="internal"><li><a class="tocitem" href="#Stratified_Asympsolver"><span>Stratified_Asympsolver</span></a></li></ul></li><li><a class="tocitem" href="generalities.html">Generalities</a></li><li><a class="tocitem" href="TestTimeStepping.html">TestTimeStepping</a></li></ul></li><li><a class="tocitem" href="../numerical-methods.html">Numerical methods</a></li><li><a class="tocitem" href="../multithreading.html">Multithreading</a></li><li><a class="tocitem" href="../plots.html">Plots</a></li><li><a class="tocitem" href="../creating-new-solvers.html">Creating new solvers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Physical systems</a></li><li class="is-active"><a href="Stratified.html">Stratified</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="Stratified.html">Stratified</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Stratified_Asympsolver"><a class="docs-heading-anchor" href="#Stratified_Asympsolver">Stratified_Asympsolver</a><a id="Stratified_Asympsolver-1"></a><a class="docs-heading-anchor-permalink" href="#Stratified_Asympsolver" title="Permalink"></a></h2><p>Internal Gravity Waves (IGW) propagate in stratified flows like the oceans and atmospheres. They are therefore important for geophysical applications (see <a href="https://doi.org/10.1175/2011JPO4129.1.">Lvov <em>et al.</em>, J. Phys. Oceanogr. 42, 669–691 (2012)</a> for a review). The <a href="Stratified.html#WavKinS.Stratified_Asymp"><code>Stratified_Asymp</code></a> solver is for the kinetic equation of IGW in the strong anisotropy (or hydrostatic) limit, where we consider that the horizontal wave vector <span>$k_h$</span> is small compared to the vertical wave vector <span>$k_z$</span>.   </p><h3 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h3><p>In the solver, we consider the WKE of <span>$3D$</span>-internal waves <span>$\dot{n_{\bf k}}=St_k$</span>. We consider that <span>$n_{\bf k}$</span> is isotropic in the plane perpendicular to the gravity (the <span>$z$</span>-axis), and therefore it is a function of the magnitude of the horizontal wavevector <span>$k_h$</span> and the vertical wavavector <span>$k_z$</span> only. It explicitly reads</p><p class="math-container">\[St_{{\bf k}} = 8 \pi ~ \int ~ \left[ \mathcal{R}^k_{12} - \mathcal{R}^1_{k2} - \mathcal{R}^2_{k1} \right] ~ k_{1h} k_{2h} ~ \mathrm{d} k_{1h} \mathrm{d} k_{2h}\]</p><p>where</p><p class="math-container">\[\mathcal{R}^k_{12} = \frac{|V_{k12}|^2}{|g&#39;| \Delta} \left( n_1 n_2 - n_{\bf k} n_1 - n_{\bf k} n_2 \right),\]</p><p>the interaction coefficients are</p><p class="math-container">\[V_{k12} = \sqrt{\frac{k_h k_{1h} k_{2h}}{32}} \left( \frac{{\bf k}_h \cdot {\bf k}_{1h}}{k_h k_{1h}} \sqrt{\left| \frac{k_{2z}}{k_z k_{1z}} \right|} + \frac{{\bf k}_h \cdot {\bf k}_{2h}}{k_h k_{2h}} \sqrt{\left| \frac{k_{1z}}{k_z k_{2z}} \right|} + \frac{{\bf k}_{1h} \cdot {\bf k}_{2h}}{k_{1h} k_{2h}} \sqrt{\left| \frac{k_z}{k_{1z} k_{2z}} \right|} \right),\]</p><p>the determinant is</p><p class="math-container">\[\Delta = \frac{1}{2} \sqrt{(- k_h + k_{1h} + k_{2h}) (k_h - k_{1h} + k_{2h}) (k_h + k_{1h} - k_{2h}) (k_h + k_{1h} + k_{2h})},\]</p><p>and </p><p class="math-container">\[g&#39; = \frac{k_{1h} {\rm sign}(k_{1z})}{k_{1z}^2} - \frac{k_{2h} ~ {\rm sign}(k_{2z})}{k_{2z}^2}.\]</p><p>This WKE results from assuming axisymmetry around the stratification axis <span>${\bf e}_{z}$</span>. The dispersion relation is</p><p class="math-container">\[\omega_k=N k_h/|k_z|\]</p><p>with <span>$N$</span> the buoyancy frequency. <span>$k_{1z}$</span>, <span>$k_{2z}$</span> are given by the solution of the resonance conditions, i.e. the joint conservation of momentum and energy in each triadic interaction (<span>${\bf k} = {\bf k}_1 + {\bf k}_2$</span> and <span>$\omega_k = \omega_1 + \omega_2$</span> for <span>$\mathcal{R}^k_{12}$</span> and so on). See <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.87.168501">Lvov and Tabak, Phys. Rev. Lett. 87, 168501 (2001)</a>,  <a href="https://www.cambridge.org/core/journals/journal-of-fluid-mechanics/article/abs/downscale-energy-fluxes-in-scaleinvariant-oceanic-internal-wave-turbulence/575CD634A844D7DACF84EBBA9FF5A084">Dematteis and Lvov, JFM 915, A129 (2021)</a> and <a href="https://arxiv.org/abs/2407.11469">Labarre <em>et al.</em>, arXiv, 2407.11469 (2024)</a>.</p><p>This wave kinetic equation conserves the total energy </p><p class="math-container">\[H = \int \omega_{\bf k} n_{\bf k} d{\bf k}.\]</p><h3 id="Solver"><a class="docs-heading-anchor" href="#Solver">Solver</a><a id="Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Solver" title="Permalink"></a></h3><h4 id="Numerical-method"><a class="docs-heading-anchor" href="#Numerical-method">Numerical method</a><a id="Numerical-method-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-method" title="Permalink"></a></h4><p>We use the symmetry <span>$k_1 \leftrightarrow k_2$</span> to write the collision integral as</p><p class="math-container">\[St_{\bf k} = St(k_h,|k_z|) = 4 \pi \int ~ \frac{L(p,q)}{\Delta(p,q)} ~ \mathrm{d}p \mathrm{d}q\]</p><p>The integral is performed over the kinematic box <span>$(p,q) \in [-k_h,k_h] \times [0,q_{\rm max}]$</span>, <span>$q_{\rm max}$</span> being a cut-off (<span>$=2k_{h,{\rm max}}$</span> by default). the kinematic box depends on <span>$k_h$</span> so you can change the number of grid points and cut-offs for each <span>$k_h$</span>. See <a href="../basics.html#WavKinS.kinematic_box"><code>kinematic_box</code></a> for more details.</p><p>We use the method <code>L_vs</code> to compute the term</p><p class="math-container">\[L(p,q) = \left. \frac{|V_{k12}|^2}{|g&#39;|} \left( n_1 n_2 - n_{\bf k} n_1 - n_{\bf k} n_2 \right) k_{1h} k_{2h} \right|_{R_k} - 2 \left. \frac{|V_{k12}|^2}{|g&#39;|} \left( n_1 n_2 - n_{\bf k} n_1 - n_{\bf k} n_2 \right) k_{1h} k_{2h} \right|_{R_1},\]</p><p>where we use the notation <span>$R_k$</span> (respectively <span>$R_1$</span>) to indicate that the terms are evaluated on the resonant manifold <span>${\bf k} = {\bf k}_1 + {\bf k}_2$</span>, <span>$\omega_{\bf k} = \omega_1 + \omega_2$</span> (respectively <span>${\bf k}_1 = {\bf k} + {\bf k}_2$</span>, <span>$\omega_1 = \omega_{\bf k} + \omega_2$</span>). For each case (<span>$R_k$</span> or <span>$R_1$</span>), there are two branches, i.e. two solutions for <span>$k_{1z}$</span> that coded in <code>k1zkp_vs</code>, <code>k1zkm_vs</code>, <code>k1z1p_vs</code> and <code>k1z1m_vs</code>.</p><p>The denominator</p><p class="math-container">\[\Delta(p,q) = \frac{1}{2} \sqrt{(k_h^2-p^2) q (2 k_h+q)}\]</p><p>is zero at the borders of the kinematic box <span>$p = \pm k_h$</span> and/or <span>$q=0$</span>, leading to integrable singularities that must be treated for accurate results.</p><p>For the contribution of the grid points with <span>$q = 0$</span>, we use</p><p class="math-container">\[\int\limits_0^{\delta k_h} ~ \frac{L(p,q)}{\Delta(p,q)} ~ \mathrm{d}q \simeq L(p,\delta k_h) \sqrt{ \frac{2 \delta}{k_h^2-p^2}}\]</p><p>with <span>$\delta \ll 1$</span>.</p><p>For the contribution of the grid points with <span>$p = -k_h$</span>, we use </p><p class="math-container">\[\int\limits_{-k_h}^{(-1+\xi) k_h} ~ \frac{L(p,q)}{\Delta(p,q)} ~ \mathrm{d}p \simeq L((-1+\xi)k_h,q) \sqrt{\frac{2 \xi}{q(2k_h+q)}}\]</p><p>with <span>$\xi \ll 1$</span>. The contribution of grid points with <span>$p = k_h$</span> is computed in the same way.</p><p>For the two grid points with <span>$p = \pm k_h$</span> and <span>$q=0$</span>, we use</p><p class="math-container">\[\int\limits_0^{\delta k_h} \int\limits_{\pm k_h}^{\pm(-1+\xi) k_h} ~ \frac{L(p,q)}{\Delta(p,q)} ~ \mathrm{d}p \mathrm{d}q \simeq  L(\pm(-1+\xi) k_h,\delta k_h) 2 \left( \pi - 2 \arcsin (1-\xi) \right) \arcsin \left( \sqrt{\delta/2} \right).\]</p><p>We use the logarithmic two-dimensional grid <a href="../basics.html#WavKinS.wave_spectrum_khkz"><code>wave_spectrum_khkz</code></a> to represent the waveaction spectrum <span>$n_{\bf k}$</span>. The different options are described in the <a href="Stratified.html#WavKinS.Stratified_Asymp"><code>Stratified_Asymp</code></a> documentation.</p><p>Note the if we use <span>$M$</span> nodes to represent each coordinate of the Fourier space, then, the numerical cost of computing the collisional integral is of the order of <span>$M^4$</span> operations, which is prohibitive. Well resolved numerical simulations with this solver therefore requires clusters.</p><h4 id="Using-the-Stratified_Asymp-solver"><a class="docs-heading-anchor" href="#Using-the-Stratified_Asymp-solver">Using the Stratified_Asymp solver</a><a id="Using-the-Stratified_Asymp-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-Stratified_Asymp-solver" title="Permalink"></a></h4><p>As all the other WavKinS solvers, we need to create a <a href="Stratified.html#WavKinS.Stratified_Asymp"><code>Stratified_Asymp</code></a> structure containing all the fields, working space, diagnostics, etc.  </p><pre><code class="language-julia hljs">using WavKinS

# Create a waveaction structure containing the basic grid
Mh = 16 # set the number of nodes for horizontal wave number
Mz = 16 # set the number of nodes for vertical wave number
khmin = 5e-3 # minimal horizontal wave number
khmax = 1e0 # maximal horizontal wave number
kzmin = 5e-3 # minimal vertical wave number
kzmax = 1e0 # maximal vertical wave number
Nk = wave_spectrum_khkz(khmin,khmax,Mh,kzmin,kzmax,Mz)

# Creating a Stratified_Asymp run structure with default parameters.
Run = WavKinS.Stratified_Asymp(Nk);</code></pre><h4 id="Diagnostics-and-special-post-processing"><a class="docs-heading-anchor" href="#Diagnostics-and-special-post-processing">Diagnostics and special post-processing</a><a id="Diagnostics-and-special-post-processing-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics-and-special-post-processing" title="Permalink"></a></h4><p>The standard diagnostics should work for this system. </p><p>In <code>src/physical_systems/Stratified/special.jl</code>, we also have implemented other methods to compute and plot spectra using other coordinates. </p><p>The function <a href="Stratified.html#WavKinS.compute_ωkz_spectrum-Tuple{Any}"><code>compute_ωkz_spectrum</code></a> computes the <span>$(\omega_{\bf k},k\simeq |k_z|)$</span> spectrum, which is widely used in oceanographic studies (<a href="https://journals.ametsoc.org/view/journals/phoc/50/3/jpo-d-19-0224.1.xml">Olbers <em>et al.</em>, J. Phys. Oceanogr. 50, 751-771 (2020)</a>).</p><p>The function <a href="Stratified.html#WavKinS.compute_ξkz_spectrum-Tuple{Any}"><code>compute_ξkz_spectrum</code></a> computes the <span>$(\xi_{\bf k}\equiv k_h/k_z^2,|k_z|)$</span> spectrum.  <span>$\xi_{\bf k} \simeq \xi_1 \simeq \xi_2$</span> for Induced Diffusion interactions (<a href="https://link.aps.org/doi/10.1103/PhysRevLett.131.264001">Lanchon and Cortet, Phys. Rev. Lett. 131, 264001 (2023)</a>), so the spectrum develops along iso-<span>$\xi_{\bf k}$</span> lines.</p><p>We also have implemented functions for plotting these spectra.</p><h4 id="Testing-convergence-of-the-collisional-integral"><a class="docs-heading-anchor" href="#Testing-convergence-of-the-collisional-integral">Testing convergence of the collisional integral</a><a id="Testing-convergence-of-the-collisional-integral-1"></a><a class="docs-heading-anchor-permalink" href="#Testing-convergence-of-the-collisional-integral" title="Permalink"></a></h4><p>WavKinS provide a simple test of the numerical convergence of the computation of the collisional integral. The testing script is located in <code>/run/tests/physical_systems/tests_Stratified_Asymp.jl</code>. </p><p>Theoretically, the collisional integral should conserve the waveaction and the energy, which means that</p><p class="math-container">\[2 \times 2 \pi \int_0^{k_{h{\rm max}}} \int_0^{k_{z{\rm max}}}  \omega_{\bf k} St_{\bf k} k_h \mathrm{d}k_h \mathrm{d}k_z = 0.\]</p><p>The following numerical test evaluates those integrals and check the convergence to <span>$0$</span>.</p><pre><code class="language-julia hljs">using WavKinS

function nk_test(kh,kz)
    return abs(kz^2)*exp(-kh - abs(kz)) * kh^1.5/(1. + abs(kz))/118
end

println(&quot;---------------------------------------------------------------------&quot;)
println(&quot;Testing collisional integral&quot;)
println(&quot;&quot;)

for j = 3:7
    Mh = 2^j
    Mz = 2^j
    khmin = 1e-2
    khmax = 1e2
    kzmin = 1e-2
    kzmax = 1e2
 
    Nk = wave_spectrum_khkz(khmin,khmax,Mh,kzmin,kzmax,Mz)
    Run = Stratified_Asymp(Nk; interp_scheeme=WavKinS.bilin_interp_khkz, integ_scheeme=integrate_with_log_bins_khkz)

    kkh = Nk.kkh
    kkz = Nk.kkz
    kk = Nk.kk
    KKH = kkh .* ones(length(kkz))&#39;
    KKZ = ones(length(kkh)) .* kkz&#39;
    @. Nk.nk = nk_test.(KKH, KKZ);

    WavKinS.St_k!(Run)

    Flux = wave_spectrum_khkz(khmin,khmax,Mh,kzmin,kzmax,Mz)
    @. Flux.nk = Run.Sk.nk * Run.ω.(KKH, KKZ) * KKH * Run.dΩ;

    Ene = energy(Run)
    FluxNumH = total_density_flux(Run, Run.ω)    
    
    println(&quot;Mh = &quot;, Mh, &quot;, Mz = &quot;, Mz, &quot;, Integral flux num: dH/H=&quot;, FluxNumH / Ene)
end

println(&quot;&quot;)
println(&quot;---------------------------------------------------------------------&quot;)</code></pre><p>The output of this test is </p><pre><code class="nohighlight hljs">---------------------------------------------------------------------
Testing collisional integral for energy conservation

Mh = 8, Mz = 8, Integral flux num: dH/H=253.3645103905745
Mh = 16, Mz = 16, Integral flux num: dH/H=3.377632098174059
Mh = 32, Mz = 32, Integral flux num: dH/H=0.5714735429013132
Mh = 64, Mz = 64, Integral flux num: dH/H=0.12038700544323301
Mh = 128, Mz = 128, Integral flux num: dH/H=0.026346960726081035

---------------------------------------------------------------------</code></pre><p>We see that the error on energy conservation roughly decreases as <span>$M^{-2}$</span>.</p><h3 id="Theoretical-predictions"><a class="docs-heading-anchor" href="#Theoretical-predictions">Theoretical predictions</a><a id="Theoretical-predictions-1"></a><a class="docs-heading-anchor-permalink" href="#Theoretical-predictions" title="Permalink"></a></h3><p>The only power law steady spectrum was found numerically (see <a href="https://journals.ametsoc.org/view/journals/phoc/40/12/2010jpo4132.1.xml">Lvov <em>et al.</em>, J. Phys. Oceanogr. 40, 2605-2623 (2010)</a>)</p><p class="math-container">\[n_{\bf k} \propto k_h^{-3.69} |k_z|^{0}.\]</p><p>Yet, any perturbation of the <span>$k_z$</span> exponent would lead to a divergence of the collision integral, making the realizability of this spectrum unclear.</p><h4 id="Running-the-Stratified_Asymp-solver"><a class="docs-heading-anchor" href="#Running-the-Stratified_Asymp-solver">Running the Stratified_Asymp solver</a><a id="Running-the-Stratified_Asymp-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-Stratified_Asymp-solver" title="Permalink"></a></h4><p>WavKinS provides a ready to use script to obtain out-of-equilibrium steady states of the WKE. The script is similar to the one presented in the tutorial and can be found in <code>/run/simple/RunSimpleEvolution_Stratified_Asymp.jl</code>. </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This script runs a simulation with very coarse resolution <span>$M_h = M_z = M = 16$</span>. Even resolution <span>$M \simeq 40$</span> requires supercomputers due to the <span>$M^4$</span> numerical cost.</p></div></div><p>Running a similar script in a HPC cluster using 128 cores and a resolution of <span>$M=80$</span> takes several weeks. The results is displayed in the figure <img src="../assets/Petviashvilii_spectrum_full.png" alt/></p><p>On the left, we observe a very early stage spectrum where only wavectors close to the forcing are excited. On the right, the spectrum is well developed and the system is close to a steady state.</p><h3 id="List-of-structures-and-methods-for-Stratified-solvers"><a class="docs-heading-anchor" href="#List-of-structures-and-methods-for-Stratified-solvers">List of structures and methods for Stratified solvers</a><a id="List-of-structures-and-methods-for-Stratified-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#List-of-structures-and-methods-for-Stratified-solvers" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.L_vs-NTuple{7, Any}" href="#WavKinS.L_vs-NTuple{7, Any}"><code>WavKinS.L_vs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">L_vs(ih,iz,p,q,Nk,val_nk,interp_scheeme)</code></pre><p>Integrand of the collision integral multiplied by <span>$Δ$</span>.</p><ul><li><code>ih</code>, <code>iz</code>: external wave vector indices</li><li><code>p</code>, <code>q</code>: coordinates on the kinematic box</li><li><code>Nk</code>: wave action spectrum</li><li><code>val_nk</code>, <code>interp_scheeme</code>: used for interpolation</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.V1_Strat_Asymp-NTuple{6, Any}" href="#WavKinS.V1_Strat_Asymp-NTuple{6, Any}"><code>WavKinS.V1_Strat_Asymp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">V1_Strat_Asymp(kh,kz,k1h,k1z,k2h,k2z)</code></pre><p>Interaction coefficient on the resonant manifold <span>${\bf k}_1 = {\bf k} + {\bf k}_2$</span>, <span>$\omega_1 = \omega_{\bf k} + \omega_2$</span> </p><ul><li><code>kh</code>, <code>k1h</code>, <code>k2h</code>: horizontal wave vector modulus</li><li><code>kz</code>, <code>k1z</code>, <code>k2z</code>: vertical wave vector</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.Vk_Strat_Asymp-NTuple{6, Any}" href="#WavKinS.Vk_Strat_Asymp-NTuple{6, Any}"><code>WavKinS.Vk_Strat_Asymp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vk_Strat_Asymp(kh,kz,k1h,k1z,k2h,k2z)</code></pre><p>Interaction coefficient on the resonant manifold <span>${\bf k} = {\bf k}_1 + {\bf k}_2$</span>, <span>$\omega_{\bf k} = \omega_1 + \omega_2$</span> </p><ul><li><code>kh</code>, <code>k1h</code>, <code>k2h</code>: horizontal wave vector modulus</li><li><code>kz</code>, <code>k1z</code>, <code>k2z</code>: vertical wave vector</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.dg_vs-NTuple{4, Any}" href="#WavKinS.dg_vs-NTuple{4, Any}"><code>WavKinS.dg_vs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dg_vs(k1h,k1z,k2h,k2z)</code></pre><p>Jacobian arizing from resonance in frequency:</p><p><span>$g&#39; = k_{1h} {\rm sign}(k_{1z})/k_{1z}^2 - k_{2h} {\rm sign}(k_{2z})/k_{2z}^2.$</span></p><ul><li><code>k1h</code>, <code>k2h</code>: horizontal wave vector modulus</li><li><code>k1z</code>, <code>k2z</code>: vertical wave vectors</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.k1z1m_vs-NTuple{4, Any}" href="#WavKinS.k1z1m_vs-NTuple{4, Any}"><code>WavKinS.k1z1m_vs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">k1z1m_vs(kh,kz,k1h,k2h)</code></pre><p><span>$k_{1z}$</span> solution of <span>${\bf k}_1 = {\bf k} + {\bf k}_2$</span>, <span>$\omega_1 = \omega_{\bf k} + \omega_2$</span> (branch -):</p><p><span>$k_{1z} = \frac{k_z}{2k_h} \left( k_h - k_{1h} + k_{2h} - \sqrt{ (-k_h + k_{1h} - k_{2h})^2 + 4 k_h k_{1h} } \right).$</span></p><ul><li><code>kh</code>, <code>k1h</code>, <code>k2h</code>: horizontal wave vector modulus</li><li><code>kz</code>: vertical wave vector</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.k1z1p_vs-NTuple{4, Any}" href="#WavKinS.k1z1p_vs-NTuple{4, Any}"><code>WavKinS.k1z1p_vs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">k1z1p_vs(kh,kz,k1h,k2h)</code></pre><p><span>$k_{1z}$</span> solution of <span>${\bf k}_1 = {\bf k} + {\bf k}_2$</span>, <span>$\omega_1 = \omega_{\bf k} + \omega_2$</span> (branch +):</p><p><span>$k_{1z} = \frac{k_z}{2k_h} \left( k_h + k_{1h} + k_{2h} - \sqrt{ (k_h + k_{1h} + k_{2h})^2 - 4 k_h k_{1h} } \right).$</span></p><ul><li><code>kh</code>, <code>k1h</code>, <code>k2h</code>: horizontal wave vector modulus</li><li><code>kz</code>: vertical wave vector</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.k1zkm_vs-NTuple{4, Any}" href="#WavKinS.k1zkm_vs-NTuple{4, Any}"><code>WavKinS.k1zkm_vs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">k1zkm_vs(kh,kz,k1h,k2h)</code></pre><p><span>$k_{1z}$</span> solution of <span>${\bf k} = {\bf k}_1 + {\bf k}_2$</span>, <span>$\omega_{\bf k} = \omega_1 + \omega_2$</span> (branch -):</p><p><span>$k_{1z} = \frac{k_z}{2k_h} \left( k_h - k_{1h} - k_{2h} - \sqrt{ (k_h - k_{1h} - k_{2h})^2 + 4 k_h k_{1h} } \right).$</span></p><ul><li><code>kh</code>, <code>k1h</code>, <code>k2h</code>: horizontal wave vector modulus</li><li><code>kz</code>: vertical wave vector</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.k1zkp_vs-NTuple{4, Any}" href="#WavKinS.k1zkp_vs-NTuple{4, Any}"><code>WavKinS.k1zkp_vs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">k1zkp_vs(kh,kz,k1h,k2h)</code></pre><p><span>$k_{1z}$</span> solution of <span>${\bf k} = {\bf k}_1 + {\bf k}_2$</span>, <span>$\omega_{\bf k} = \omega_1 + \omega_2$</span> (branch +):</p><p><span>$k_{1z} = \frac{k_z}{2k_h} \left( k_h + k_{1h} + k_{2h} + \sqrt{ (k_h + k_{1h} + k_{2h})^2 - 4 k_h k_{1h} } \right).$</span></p><ul><li><code>kh</code>, <code>k1h</code>, <code>k2h</code>: horizontal wave vector modulus</li><li><code>kz</code>: vertical wave vector</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.ω_Stratified_Asymp-Tuple{Any, Any}" href="#WavKinS.ω_Stratified_Asymp-Tuple{Any, Any}"><code>WavKinS.ω_Stratified_Asymp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ω_Stratified_Asymp(kh, kz; N=1.0)</code></pre><p>Internal gravity wave frequency in the hydrostatic limit</p><ul><li><code>kh</code>: horizontal wave vector modulus</li><li><code>kz</code>: vertical wave vector</li><li><code>N=1.0</code>: buoyancy frequency</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.Stratified_Asymp" href="#WavKinS.Stratified_Asymp"><code>WavKinS.Stratified_Asymp</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Stratified_Asymp</code></pre><p>Simulation structure for internal gravity wave turbulence in the hydrostatic limit <span>$k_h \ll |k_z|$</span>. It contains</p><pre><code class="nohighlight hljs">name::String #name of the simulation type
Nk_arguments::Int # Number of arguments of ``n_k``. 1: (fully symetric) , 2: (cylindrical average in 3D or mirror symmetric in 2D), 3: Only mirror symmetric in 3D
ω # Dispersion relation. This is a function of ``k``. It takes `Nk_argument` arguments

Nk::wave_spectrum_khkz #wave action
Sk::wave_spectrum_khkz #collisional integral
F1::wave_spectrum_khkz #working field
kin_box::kinematic_box #kinematic box: meshes for a (p) and q
FStp::Vector{Vector{Float64}} #Array of working fields for multithreading
FStq::Vector{Vector{Float64}} #Array of working fields for multithreading
partition::Vector{Tuple{UnitRange{Int64},UnitRange{Int64}}} #partition for multithreading

# Type of interpolation, integration, and time stepping scheemes
interp_scheeme::Interp_Scheeme
integ_scheeme::Integ_Scheeme
time_stepping::Time_Stepping

# Outputs and diagnostics
diags::diagnostic_container

t::Float64 #current time
N::Float64 #buoyancy (Brünt Väisälä) frequency
dimension::Int # physical dimension of the system (or of the isotropic sector)
dΩ::Float64 # surface of the unit sphere (or of the isotropic sector)

FD::force_dissipation # Contains all the terms about force and dissipation.</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.Stratified_Asymp-Tuple{wave_spectrum_khkz}" href="#WavKinS.Stratified_Asymp-Tuple{wave_spectrum_khkz}"><code>WavKinS.Stratified_Asymp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Stratified_Asymp(Nk::wave_spectrum_khkz; interp_scheeme=bilin_interp_khkz,integ_scheeme=integrate_with_log_bins_khkz,time_stepping_scheeme=RK2_step,Mp=0,Mq=0,nthh=0,nthz=0,N=1.0)</code></pre><p>Constructor of a <a href="Stratified.html#WavKinS.Stratified_Asymp"><code>Stratified_Asymp</code></a> structure. Optionally we set interpolation and time-stepping scheemes:</p><ul><li><code>interp_scheeme</code>: <a href="../numerical-methods.html#WavKinS.bilin_interp_khkz-Tuple{AbstractVector, AbstractVector}"><code>bilin_interp_khkz</code></a> (default), <a href="../numerical-methods.html#WavKinS.cpow_interp_khkz-Tuple{AbstractVector, AbstractVector}"><code>cpow_interp_khkz</code></a></li><li><code>integ_scheeme</code> : <a href="../numerical-methods.html#WavKinS.integrate_with_log_bins_khkz"><code>integrate_with_log_bins_khkz</code></a> (default), <a href="../numerical-methods.html#WavKinS.integrate_with_cpow_khkz"><code>integrate_with_cpow_khkz</code></a></li><li><code>time_stepping_scheeme</code> : <a href="../numerical-methods.html#WavKinS.Euler_step"><code>Euler_step</code></a>, <a href="../numerical-methods.html#WavKinS.RK2_step"><code>RK2_step</code></a> (default), <a href="../numerical-methods.html#WavKinS.RK4_step"><code>RK4_step</code></a></li></ul><p>You can also change:</p><ul><li><code>Mp</code>, <code>Mq</code>: number of grid points of the kinematic box in <span>$p$</span> and <span>$q$</span> directions</li><li><code>nthh</code>, <code>nthz</code>: number of slices in <span>$k_h$</span> and <span>$k_z$</span> for multithreading</li><li><code>N=1.0</code>: buoyancy frequency</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.St_k!-Tuple{Stratified_Asymp}" href="#WavKinS.St_k!-Tuple{Stratified_Asymp}"><code>WavKinS.St_k!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">St_k!(Run::Stratified_Asymp)</code></pre><p>Compute collision integral for <a href="Stratified.html#WavKinS.Stratified_Asymp"><code>Stratified_Asymp</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.compute_spectral!-Tuple{Stratified_Asymp}" href="#WavKinS.compute_spectral!-Tuple{Stratified_Asymp}"><code>WavKinS.compute_spectral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_spectral(Run)</code></pre><p>Compute and store Stratified_Asymp current spectral quantities</p><ul><li><code>Run</code>: Stratified<em>Asymp WavKinS simulation structure containing the wave action ``n</em>{\bf k}``</li></ul><p>This routine computes and store in <code>Run.diags.sp_outs</code> the waveaction, energy spectra and their corresponding fluxes.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.store_spectral!-Tuple{Stratified_Asymp}" href="#WavKinS.store_spectral!-Tuple{Stratified_Asymp}"><code>WavKinS.store_spectral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">store_spectral(Run::Stratified_Asymp)</code></pre><p>Compute and store Stratified_Asymp spectral quantities</p><ul><li><code>Run</code>: Stratified<em>Asymp WavKinS simulation structure containing the wave action ``n</em>{\bf k}``</li></ul><p>This routine computes and store in <code>Run.diags.sp_store</code>  the waveaction, and the energy and waveaction flux spectra.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.compute_ξkz_spectrum-Tuple{Any}" href="#WavKinS.compute_ξkz_spectrum-Tuple{Any}"><code>WavKinS.compute_ξkz_spectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>compute_ξkz_spectrum(Run; ρ=one)</code></p><p>Compute <span>$(ξ_{\bf k},|k_z|)$</span> spectrum for the quantity with spectral density <code>ρ</code>, where <span>$ξ_{\rm k}=k_h/k_z^2$</span>. It relates to the 3D wave action spectrum <span>$n_{\bf k}$</span> by <span>$s(ξ_{\bf k},|k_z|) = 2 \rho_{\bf k} ξ_{\bf k} k_z^4 \mathrm{d} \Omega n_{\rm k}$</span>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.compute_ωkz_spectrum-Tuple{Any}" href="#WavKinS.compute_ωkz_spectrum-Tuple{Any}"><code>WavKinS.compute_ωkz_spectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>compute_ωkz_spectrum(Run; ρ=one)</code></p><p>Compute <span>$(\omega_{\bf k},|k_z|)$</span> spectrum for the quantity with spectral density <code>ρ</code>. It relates to the 3D wave action spectrum <span>$n_{\bf k}$</span> by <span>$s(\omega_{\bf k},|k_z|) = 2 \rho_{\bf k} \omega_{\bf k} (k_z/N)^2 \mathrm{d} \Omega n_{\rm k}$</span>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.plot_slices_kzξ_spectrum!-Tuple{Any}" href="#WavKinS.plot_slices_kzξ_spectrum!-Tuple{Any}"><code>WavKinS.plot_slices_kzξ_spectrum!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>plot_slices_kzξ_spectrum!(Run; ρ=one, title=&quot;Quantity spectrum&quot;)</code></p><p>Plot slices of the <span>$(ξ_{\bf k},|k_z|)$</span> spectrum for the quantity with spectral density <code>ρ</code>. See <a href="Stratified.html#WavKinS.compute_ξkz_spectrum-Tuple{Any}"><code>compute_ξkz_spectrum</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.plot_slices_kzω_spectrum!-Tuple{Any}" href="#WavKinS.plot_slices_kzω_spectrum!-Tuple{Any}"><code>WavKinS.plot_slices_kzω_spectrum!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>plot_slices_kzω_spectrum!(Run; ρ=one, title=&quot;Quantity spectrum&quot;)</code></p><p>Plot slices of the <span>$(ω_{\bf k},|k_z|)$</span> spectrum for the quantity with spectral density <code>ρ</code>. See <a href="Stratified.html#WavKinS.compute_ωkz_spectrum-Tuple{Any}"><code>compute_ωkz_spectrum</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.plot_slices_ξkz_spectrum!-Tuple{Any}" href="#WavKinS.plot_slices_ξkz_spectrum!-Tuple{Any}"><code>WavKinS.plot_slices_ξkz_spectrum!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>plot_slices_ξkz_spectrum!(Run; ρ=one, title=&quot;Quantity spectrum&quot;)</code></p><p>Plot slices of the <span>$(ξ_{\bf k},|k_z|)$</span> spectrum for the quantity with spectral density <code>ρ</code>. See <a href="Stratified.html#WavKinS.compute_ξkz_spectrum-Tuple{Any}"><code>compute_ξkz_spectrum</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.plot_slices_ωkz_spectrum!-Tuple{Any}" href="#WavKinS.plot_slices_ωkz_spectrum!-Tuple{Any}"><code>WavKinS.plot_slices_ωkz_spectrum!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>plot_slices_ωkz_spectrum!(Run; ρ=one, title=&quot;Quantity spectrum&quot;)</code></p><p>Plot slices of the <span>$(ω_{\bf k},|k_z|)$</span> spectrum for the quantity with spectral density <code>ρ</code>. See <a href="Stratified.html#WavKinS.compute_ωkz_spectrum-Tuple{Any}"><code>compute_ωkz_spectrum</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.plot_ξkz_spectrum!-Tuple{Any}" href="#WavKinS.plot_ξkz_spectrum!-Tuple{Any}"><code>WavKinS.plot_ξkz_spectrum!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>plot_ξkz_spectrum!(Run; ρ=one, title=&quot;Quantity spectrum&quot;)</code></p><p>Plot <span>$(ξ_{\bf k},|k_z|)$</span> spectrum for the quantity with spectral density <code>ρ</code>. See <a href="Stratified.html#WavKinS.compute_ξkz_spectrum-Tuple{Any}"><code>compute_ξkz_spectrum</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.plot_ω_spectrum_density!-Tuple{Any}" href="#WavKinS.plot_ω_spectrum_density!-Tuple{Any}"><code>WavKinS.plot_ω_spectrum_density!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>plot_ω_spectrum_density!(Run; ρ=one, title=&quot;Quantity spectrum&quot;)</code></p><p>Plot frequency spectrum for the quantity with spectral density <code>ρ</code> by integrating the <span>$(ω_{\bf k},|k_z|)$</span> spectrum over <span>$|k_z|$</span>. See <a href="Stratified.html#WavKinS.compute_ωkz_spectrum-Tuple{Any}"><code>compute_ωkz_spectrum</code></a>. </p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.plot_ωkz_spectrum!-Tuple{Any}" href="#WavKinS.plot_ωkz_spectrum!-Tuple{Any}"><code>WavKinS.plot_ωkz_spectrum!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>plot_ωkz_spectrum!(Run; ρ=one, title=&quot;Quantity spectrum&quot;)</code></p><p>Plot <span>$(ω_{\bf k},|k_z|)$</span> spectrum for the quantity with spectral density <code>ρ</code>. See <a href="Stratified.html#WavKinS.compute_ωkz_spectrum-Tuple{Any}"><code>compute_ωkz_spectrum</code></a>.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="Smoluchowski.html">« Smoluchowski</a><a class="docs-footer-nextpage" href="generalities.html">Generalities »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 9 December 2024 21:53">Monday 9 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
