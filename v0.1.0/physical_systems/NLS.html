<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>NLS · WavKinS.jl</title><meta name="title" content="NLS · WavKinS.jl"/><meta property="og:title" content="NLS · WavKinS.jl"/><meta property="twitter:title" content="NLS · WavKinS.jl"/><meta name="description" content="Documentation for WavKinS.jl."/><meta property="og:description" content="Documentation for WavKinS.jl."/><meta property="twitter:description" content="Documentation for WavKinS.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="WavKinS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">WavKinS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Quick start</span><ul><li><a class="tocitem" href="../quick_start/installation.html">Installing WavKinS</a></li><li><a class="tocitem" href="../quick_start/collisional_integral_tutorial.html">Computing a collisional integral</a></li><li><a class="tocitem" href="../quick_start/running_tutorial.html">Running an example</a></li><li><a class="tocitem" href="../quick_start/diagnostics_tutorial.html">Adding a diagnostic</a></li></ul></li><li><a class="tocitem" href="../basics.html">Basics</a></li><li><span class="tocitem">Physical systems</span><ul><li><a class="tocitem" href="Acoustic.html">Acoustic</a></li><li><a class="tocitem" href="Bogoliubov.html">Bogoliubov</a></li><li class="is-active"><a class="tocitem" href="NLS.html">NLS</a><ul class="internal"><li><a class="tocitem" href="#NLS3Dsolver"><span>NLS3Dsolver</span></a></li></ul></li><li><a class="tocitem" href="MMT.html">MMT</a></li><li><a class="tocitem" href="Petviashvilli.html">Petviashvilli</a></li><li><a class="tocitem" href="Smoluchowski.html">Smoluchowski</a></li><li><a class="tocitem" href="Stratified.html">Stratified</a></li><li><a class="tocitem" href="generalities.html">Generalities</a></li><li><a class="tocitem" href="TestTimeStepping.html">TestTimeStepping</a></li></ul></li><li><a class="tocitem" href="../numerical-methods.html">Numerical methods</a></li><li><a class="tocitem" href="../multithreading.html">Multithreading</a></li><li><a class="tocitem" href="../plots.html">Plots</a></li><li><a class="tocitem" href="../creating-new-solvers.html">Creating new solvers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Physical systems</a></li><li class="is-active"><a href="NLS.html">NLS</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="NLS.html">NLS</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="NLS3Dsolver"><a class="docs-heading-anchor" href="#NLS3Dsolver">NLS3Dsolver</a><a id="NLS3Dsolver-1"></a><a class="docs-heading-anchor-permalink" href="#NLS3Dsolver" title="Permalink"></a></h2><p>The nonlinear Schrodinger (NLS) equation is one of the most important model in physics. It applications vary from nonlinear optics, water waves to Bose-Einsteing condensates. The equation is also known as the Gross-Pitaevskii equation, a fundamental equation describing superfluids.</p><h3 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h3><p>In the solver, we consider the WKE of the <span>$3D$</span>-NLS model <span>$\dot{n_k}=St_k$</span> that explicitly reads</p><p class="math-container">\[
\dot{n_k}=4\pi \int \delta({\bf k+k_1-k_2-k_3})\delta(\omega^{k1}_{23})n_kn_1n_2n_3\left(\frac{1}{n_{\bf k}}+\frac{1}{n_{\bf 1}}-\frac{1}{n_{\bf 2}}-\frac{1}{n_{\bf 3}}   \right)d{\bf k_1}d{\bf k_2}d{\bf k_3}, \]</p><p>where <span>$\omega^{k1}_{23}=\omega_k+\omega_1-\omega_2-\omega_3$</span>, with <span>$\omega_k = k^2$</span>. Note that in the general case, there are <span>$3\times3 -3 -1=5$</span> integrals to be performed for each element of in wavevector space. Solving this equation will then require <span>$M^8$</span> operation per time-step, where <span>$M$</span> is the number of discretization points of the wavevector space in each direction. Such an enormous cost makes the simulation numerically unfeasible. In WavKinS, we assume isotropy and consider the isotropic kinetic equation which drastically reduces the number of computations.</p><p>This wave kinetic equation conserves the total energy <span>$H$</span> and waveaction <span>$N$</span></p><p class="math-container">\[N= \int  n_{\bf k}d{\bf k}, \quad {\rm and }\quad H = \int \omega_{\bf k} n_{\bf k}d{\bf k}.\]</p><h3 id="Solver"><a class="docs-heading-anchor" href="#Solver">Solver</a><a id="Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Solver" title="Permalink"></a></h3><h4 id="The-reduced-isotropic-NLS-wave-kinetic-equation"><a class="docs-heading-anchor" href="#The-reduced-isotropic-NLS-wave-kinetic-equation">The reduced isotropic NLS wave kinetic equation</a><a id="The-reduced-isotropic-NLS-wave-kinetic-equation-1"></a><a class="docs-heading-anchor-permalink" href="#The-reduced-isotropic-NLS-wave-kinetic-equation" title="Permalink"></a></h4><p>WavKinS solves the isotropic 3DNLS wave kinetic equation (see <a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.106.014205">Zhu <em>et al.</em>, Phys. Rev. E 106, 014205 (2022)</a> for a recent derivation and revision of prefactors). After angle average, the collisional integral simplifies considerable and reduces to a bi-dimensional integral. In WavKinS, the collisional integral is computed after performing a change of variable to <span>$\omega=k^2$</span>. The isotropic NLS3D WKE is</p><p class="math-container">\[\dot{n_k}=\frac{4\pi^3}{k} \int \mathcal{S}^{k1}_{23}\delta(\omega^{k1}_{23})\, n_kn_1n_2n_3\left(\frac{1}{n_k}+\frac{1}{n_1}-\frac{1}{n_2}-\frac{1}{n_3}   \right)d\omega_1d\omega_2d\omega_3,\]</p><p>with <span>$\mathcal{S}^{k1}_{23}=\theta_k\theta_1\theta_2\theta_3 \min{[k,\sqrt{\omega_1},\sqrt{\omega_2},\sqrt{\omega_3}]}$</span> and <span>$\theta_k = 1$</span> if <span>$|k|\le k_{\rm max}$</span>, and <span>$0$</span> otherwise, with <span>$k_{\rm max}$</span> the maximum wavenumber. Note that the integration over the resonant manifold is simply given by replacing <span>$\omega_1=\omega_2+\omega_3-\omega_k$</span>.</p><p>This truncated WKE, exactly conserves the truncated invariants <a href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.108.064207">Zhu <em>et al.</em>, Phys. Rev. E 108, 064207 (2023)</a></p><p class="math-container">\[N=  4\pi \int_0^{k_{\rm max}} n_kk^2dk, \quad {\rm and }\quad H = 4\pi \int_0^{k_{\rm max}} \omega_k n_kk^2dk.\]</p><p>Note that the numerical cost is now reduced to <span>$M^3$</span>.</p><h4 id="Numerical-method"><a class="docs-heading-anchor" href="#Numerical-method">Numerical method</a><a id="Numerical-method-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-method" title="Permalink"></a></h4><p>Due to the truncation term <span>$\theta_1\theta_2\theta_3$</span> the integration domain of the WKE is bounded and reduced to the following domain</p><p class="math-container">\[0\le\omega_1,\omega_2,\omega_3\le k_{\rm max}^2,\]</p><p>which correspond to the coloured area in the figure. <img src="../assets/NLS_IntDomain.png" alt/></p><p>We use logarithmic grid <a href="../basics.html#WavKinS.wave_spectrum"><code>wave_spectrum</code></a> to represent the waveaction spectrum <span>$n_k$</span>. The integrals in the collisional term are also computed <a href="../basics.html#WavKinS.wave_spectrum"><code>wave_spectrum</code></a> structures supported on <span>$(0,k_{\rm max}^2]$</span>, and taking care of the boundaries of the domain that can be out of grid. There are no singular terms to take care of. </p><p>The different options are described in the <a href="NLS.html#WavKinS.NLS3D"><code>NLS3D</code></a> documentation.</p><h4 id="Using-the-NLS3D-solver"><a class="docs-heading-anchor" href="#Using-the-NLS3D-solver">Using the NLS3D solver</a><a id="Using-the-NLS3D-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-NLS3D-solver" title="Permalink"></a></h4><p>As all the other WavKinS solvers, for NLS3D we need to create a <a href="NLS.html#WavKinS.NLS3D"><code>NLS3D</code></a> structure containing all the fields, working space, diagnostics, etc.  </p><pre><code class="language-julia hljs">using WavKinS

# Create a waveaction structure containing the basic grid
M = 256 # set the number of nodes
kmin = .9e-3 # minimal wave number
kmax = 5e+0 # maximal wave number
Nk = wave_spectrum(kmin, kmax, M)

# Creating a NLS3D run structure with default parameters.
Run = WavKinS.NLS3D(Nk);</code></pre><p>The NLS3D solver has implemented an option to compute the collisional term as a sink and a source term</p><p class="math-container">\[St_{\bf k} = -\gamma_{\bf k} n_{\bf k} + \eta_{\bf k}\]</p><p>The computation of <span>$γ$</span> and <span>$η$</span> are performed with the options <code>compute_γk</code> and <code>compute_ηk</code> and accesible as:    </p><pre><code class="language-julia hljs"># computing collisional integral
St_k!(Run;compute_Sk=true, compute_γk=true, compute_ηk=true)
γ_k = Run.γk
η_k = Run.ηk    </code></pre><p>If both, <code>compute_γk=false</code> and <code>compute_ηk=false</code>, then <span>$St_k$</span> is computed directly.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The NLS3D solver is compatible with the time stepping <code>AB_Euler_step</code> and <code>AB2_RK2_step</code>, but still under testing. </p></div></div><h4 id="Diagnostics"><a class="docs-heading-anchor" href="#Diagnostics">Diagnostics</a><a id="Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics" title="Permalink"></a></h4><p>In addition to the standard diagnostics, the solver computes the waveaction flux spectrum.</p><p class="math-container">\[Q_k = -4\pi\int_0^k St_q q^2dq\]</p><p>Spectral and global quantities can be directly computed using the provided routines (see  <a href="../quick_start/diagnostics_tutorial.html#Defining-a-new-diagnostic"><code>this tutorial</code></a>). It is stored in </p><pre><code class="language-julia hljs">  Run.diags.sp_outs[&quot;Qk&quot;] # for I/0 purposes
  Run.diags.sp_store[&quot;Qk&quot;] # stored over time</code></pre><h4 id="Testing-convergence-of-the-collisional-integral"><a class="docs-heading-anchor" href="#Testing-convergence-of-the-collisional-integral">Testing convergence of the collisional integral</a><a id="Testing-convergence-of-the-collisional-integral-1"></a><a class="docs-heading-anchor-permalink" href="#Testing-convergence-of-the-collisional-integral" title="Permalink"></a></h4><p>WavKinS provide a simple test of the numerical convergence of the computation of the collisional integral. The testing script is located in <code>/run/tests/physical_systems/tests_NLS3D.jl</code>. </p><p>Theoretically, the collisional integral should conserve the waveaction and the energy, which means that</p><p class="math-container">\[\int_0^{k_{\rm max}} St_k k^2 dk=0, \quad \int_0^{k_{\rm max}} \omega_k St_k k^2dk=0.\]</p><p>The following numerical test evaluates those integrals and check the convergence to <span>$0$</span>.</p><pre><code class="language-julia hljs">using WavKinS

function nk_test(kx)
    return exp(-abs(kx)^2) * kx^2
end

println(&quot;---------------------------------------------------------------------&quot;)
println(&quot;Testing collisional integral&quot;)
println(&quot;&quot;)

for M ∈ 2 .^ (4:9)
    kmin = 1e-2
    kmax = 1e+1

    Nk = wave_spectrum(kmin, kmax, M)
    Run = WavKinS.NLS3D(Nk)

    kk = Nk.kk
    @. Nk.nk = nk_test.(kk)

    WavKinS.St_k!(Run; compute_Sk=true, compute_γk=false, compute_ηk=false)

    Flux = wave_spectrum(kmin, kmax, M)
    @. Flux.nk = kk^4 * Run.Sk.nk
    FluxNumH = integrate_with_log_bins(Flux)

    @. Flux.nk = kk^2 * Run.Sk.nk
    FluxNumN = integrate_with_log_bins(Flux)

    AA = total_waveaction(Run)
    Ene = energy(Run)

    println(&quot;M in k= &quot;, M, &quot;, Integral flux num: dN/n=&quot;, FluxNumN / AA, &quot; dH/H=&quot;, FluxNumH / Ene)
end

println(&quot;&quot;)
println(&quot;---------------------------------------------------------------------&quot;)</code></pre><p>The output of this test is </p><pre><code class="nohighlight hljs">---------------------------------------------------------------------
Testing collisional integral

M in k= 16, Integral flux num: dN/n=-1.1921326630233626 dH/H=-1.4541383004395845
M in k= 32, Integral flux num: dN/n=-0.44858827560085296 dH/H=-0.550829241400805
M in k= 64, Integral flux num: dN/n=-0.13109042503536641 dH/H=-0.169719084207455
M in k= 128, Integral flux num: dN/n=-0.03668301242101203 dH/H=-0.04868205790683482
M in k= 256, Integral flux num: dN/n=-0.009695220531387884 dH/H=-0.012918492831232576
M in k= 512, Integral flux num: dN/n=-0.0026314061815940525 dH/H=-0.003391676130269483

---------------------------------------------------------------------</code></pre><p>The solver conserves well the waveaction and errors on energy conservation roughly decreases as <span>$M^{-2}$</span>.</p><h3 id="Theoretical-predictions"><a class="docs-heading-anchor" href="#Theoretical-predictions">Theoretical predictions</a><a id="Theoretical-predictions-1"></a><a class="docs-heading-anchor-permalink" href="#Theoretical-predictions" title="Permalink"></a></h3><p>The wave turbulence theory provides analytical prediction for out-of-equilibrium steady states obtained with forcing and dissipation. The theory predict a inverse cascade of waveaction and a direct cascade of energy. The corresponding theoretical prediction are (see <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.130.133001">Zhu <em>et al.</em>, Phys. Rev. Lett. 130, 133001 (2023)</a> :</p><p class="math-container">\[n_k=C_{KZ}^Q |Q_0|^{1/3}k^{-7/3},\quad n_k=C_{KZ}^P P_0^{1/3}k^{-3}\ln^{-1/3}{(k/k_f)}\]</p><p>where <span>$Q_0$</span> and <span>$P_0$</span> are the waveaction and energy fluxes, and the superscript <span>$Q$</span> and <span>$P$</span> denotes the inverse waveaction and direct energy cascades, respectively. Here, <span>$k_f$</span> denotes the forcing scale appearing due to non-locality of the direct energy cascade. The theory also predicts the values of the dimensionless constants</p><p class="math-container">\[C_{KZ}^Q =7.577\times 10^{-2}  ,\quad C_{KZ}^P=5.26\times 10^{-2} \]</p><h4 id="Running-the-NLS3D-solver"><a class="docs-heading-anchor" href="#Running-the-NLS3D-solver">Running the NLS3D solver</a><a id="Running-the-NLS3D-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-NLS3D-solver" title="Permalink"></a></h4><p>WavKinS provides a ready to use script to obtain out-of-equilibrium steady states of the WKE. The script is similar to the one presented in the tutorial and can be found in <code>/run/simple/RunSimpleEvolution_NLS3D.jl</code>. Running the script will generate the following plot exhibiting the steady state inverse waveaction cascade</p><p><img src="../assets/NLS3D_spectrum.png" alt/> The dashed lines are the theoretical predictions for the inverse waveaction (green) and direct energy (red) cascades, with no adjustable parameters.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>The previous plot took 290 seconds on a 3 GHz 10-Core Intel Xeon W iMac Pro, using 4 cores. </p></div></div><h3 id="List-of-structures-and-methods-for-NLS-solvers"><a class="docs-heading-anchor" href="#List-of-structures-and-methods-for-NLS-solvers">List of structures and methods for NLS solvers</a><a id="List-of-structures-and-methods-for-NLS-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#List-of-structures-and-methods-for-NLS-solvers" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.NLS3D" href="#WavKinS.NLS3D"><code>WavKinS.NLS3D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NLS3D</code></pre><p>Simulation structure for MMT wave turbulence. It contains</p><pre><code class="nohighlight hljs">name::String #name of the simulation type
Nk_arguments::Int # Number of arguments of ``n_k``.  1: (fully symetric) , 2: (cylindrical average in 3D or mirror symmetric in 2D), 3: Only mirror symmetric in 3D
ω # Dispersion relation. This is a function of ``k``. It takes `Nk_argument` arguments

Nk::wave_spectrum #wave action
Sk::wave_spectrum #collisional integral
γk::Vector{Float64} # gamma term of WKE
ηk::Vector{Float64} # eta term of WKE

F1::wave_spectrum #working field
FSt::Vector{wave_spectrum} #Array of working fields for multithreading
FSt1::Vector{wave_spectrum} #Array of working fields for multithreading
FSt2::Vector{wave_spectrum} #Array of working fields for multithreading
FSt3::Vector{wave_spectrum} #Array of working fields for multithreading
FSt4::Vector{wave_spectrum} #Array of working fields for multithreading
FSt5::Vector{wave_spectrum} #Array of working fields for multithreading

partition::Vector{UnitRange{Int64}} #partition for multithreading

# Type of interpolation ,integration, and time stepping scheemes
interp_scheeme::Interp_Scheeme
integ_scheeme::Integ_Scheeme
time_stepping::Time_Stepping

# Outputs and diagnostics
diags::diagnostic_container

t::Float64 #current time
dimension::Int # physical dimension of the system
dΩ::Float64 # surface of the unit sphere

FD::force_dissipation # Contains all the terms about force and dissipation</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.NLS3D-Tuple{wave_spectrum}" href="#WavKinS.NLS3D-Tuple{wave_spectrum}"><code>WavKinS.NLS3D</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NLS3D(Nk::wave_spectrum;interp_scheeme=lin_interp,drive_scheeme=RK2_step)</code></pre><p>Constructor of a <code>NLS3D</code> structure. Optionally we set interpolation and time-stepping scheemes:</p><ul><li><code>interp_scheem</code> : lin<em>interp (default), powexp</em>interp, powGauss<em>interp,BS</em>interp</li><li><code>time_stepping_scheeme</code>: <a href="../numerical-methods.html#WavKinS.Euler_step"><code>Euler_step</code></a>, <a href="../numerical-methods.html#WavKinS.RK2_step"><code>RK2_step</code></a> (default), <a href="../numerical-methods.html#WavKinS.RK4_step"><code>RK4_step</code></a>, <a href="../numerical-methods.html#WavKinS.ETD2_step"><code>ETD2_step</code></a> and <a href="../numerical-methods.html#WavKinS.ETD4_step"><code>ETD4_step</code></a></li></ul><p>The parameter <code>β=0.</code> is the exponent of non-linear term</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.compute_spectral!-Tuple{NLS3D}" href="#WavKinS.compute_spectral!-Tuple{NLS3D}"><code>WavKinS.compute_spectral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_spectral(Run)</code></pre><p>Compute and store NLS3D current spectral quantities</p><ul><li><code>Run</code>: NLS3D WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li></ul><p>This routine computes and store in <code>Run.diags.sp_outs</code> the waveaction, energy spectra and their corresponding fluxes.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.store_spectral!-Tuple{NLS3D}" href="#WavKinS.store_spectral!-Tuple{NLS3D}"><code>WavKinS.store_spectral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">store_spectral(Run::NLS3D)</code></pre><p>Compute and store NLS3D spectral quantities</p><ul><li><code>Run</code>: NLS3D WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li></ul><p>This routine computes and store in <code>Run.diags.sp_store</code>  the waveaction, and the energy and waveaction flux spectra.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="Bogoliubov.html">« Bogoliubov</a><a class="docs-footer-nextpage" href="MMT.html">MMT »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 9 December 2024 21:53">Monday 9 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
