<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · WavKinS.jl</title><meta name="title" content="Home · WavKinS.jl"/><meta property="og:title" content="Home · WavKinS.jl"/><meta property="twitter:title" content="Home · WavKinS.jl"/><meta name="description" content="Documentation for WavKinS.jl."/><meta property="og:description" content="Documentation for WavKinS.jl."/><meta property="twitter:description" content="Documentation for WavKinS.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="WavKinS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">WavKinS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Home</a><ul class="internal"><li><a class="tocitem" href="#License"><span>License</span></a></li><li><a class="tocitem" href="#General-description"><span>General description</span></a></li><li><a class="tocitem" href="#Physical-systems"><span>Physical systems</span></a></li><li><a class="tocitem" href="#Code-structure"><span>Code structure</span></a></li><li><a class="tocitem" href="#Contributors"><span>Contributors</span></a></li></ul></li><li><span class="tocitem">Quick start</span><ul><li><a class="tocitem" href="quick_start/installation.html">Installing WavKinS</a></li><li><a class="tocitem" href="quick_start/collisional_integral_tutorial.html">Computing a collisional integral</a></li><li><a class="tocitem" href="quick_start/running_tutorial.html">Running an example</a></li><li><a class="tocitem" href="quick_start/diagnostics_tutorial.html">Adding a diagnostic</a></li></ul></li><li><a class="tocitem" href="basics.html">Basics</a></li><li><span class="tocitem">Physical systems</span><ul><li><a class="tocitem" href="physical_systems/Acoustic.html">Acoustic</a></li><li><a class="tocitem" href="physical_systems/Bogoliubov.html">Bogoliubov</a></li><li><a class="tocitem" href="physical_systems/NLS.html">NLS</a></li><li><a class="tocitem" href="physical_systems/MMT.html">MMT</a></li><li><a class="tocitem" href="physical_systems/Petviashvilli.html">Petviashvilli</a></li><li><a class="tocitem" href="physical_systems/Smoluchowski.html">Smoluchowski</a></li><li><a class="tocitem" href="physical_systems/Stratified.html">Stratified</a></li><li><a class="tocitem" href="physical_systems/generalities.html">Generalities</a></li><li><a class="tocitem" href="physical_systems/TestTimeStepping.html">TestTimeStepping</a></li></ul></li><li><a class="tocitem" href="numerical-methods.html">Numerical methods</a></li><li><a class="tocitem" href="multithreading.html">Multithreading</a></li><li><a class="tocitem" href="plots.html">Plots</a></li><li><a class="tocitem" href="creating-new-solvers.html">Creating new solvers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Home</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="WavKinS:-Wave-Kinetic-equations-Solver"><a class="docs-heading-anchor" href="#WavKinS:-Wave-Kinetic-equations-Solver">WavKinS: Wave Kinetic equations Solver</a><a id="WavKinS:-Wave-Kinetic-equations-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#WavKinS:-Wave-Kinetic-equations-Solver" title="Permalink"></a></h1><p>Wave kinetic equations arrive in many physical systems, such as plasmas, geophysical fluids, elastic plates, turbulent Bose-Einstein condensates, and many others. When the nonlinearity is small, the theory of Weak Wave Turbulence (WWT) provides a close equation describing the evolution of the wave spectrum, roughly describing the wave amplitude or energy at a given scale. WavKinS currently solves kinetic equations of the 3—and 4-wave types, as described below.</p><p>WavKinS is software developed in the <a href="https://julialang.org">Julia</a> language. It aims to provide a simple and efficient general solver of wave kinetic equations. Thanks to the structures and routines already developed in WavKinS, we expect developing a new solver for a specific physical system to be simple.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>WavKinS is a project under development; many routines could still be improved for accuracy or efficiency. All remarks and contributions from the scientific community are welcome! </p></div></div><h2 id="License"><a class="docs-heading-anchor" href="#License">License</a><a id="License-1"></a><a class="docs-heading-anchor-permalink" href="#License" title="Permalink"></a></h2><p>WavKinS.jl is an Open Source project distributed with <a href="https://interoperable-europe.ec.europa.eu/collection/eupl">EUPL-1.2</a> license agreement. </p><div class="admonition is-info"><header class="admonition-header">Citing WavKinS and intellectual recognition</header><div class="admonition-body"><p>In addition to the EUPL obligations; the use of this Work for the analysis, creation or modification of data imposes on the Licensee, in each of their publications resulting from the exploitation of these data, the obligation to cite the first articles where this Work was used: <a href="https://arxiv.org/abs/2407.11469">V. Labarre, G. Krstulovic and S. Nazarenko arXiv:2407.11469</a> and <a href="https://arxiv.org/abs/2408.15163">Y. Zhu, G. Krstulovic and S. Nazarenko arXiv:2408.15163</a>.</p></div></div><h2 id="General-description"><a class="docs-heading-anchor" href="#General-description">General description</a><a id="General-description-1"></a><a class="docs-heading-anchor-permalink" href="#General-description" title="Permalink"></a></h2><p>This program solves the Wave Kinetic Equation (WKE)</p><p class="math-container">\[\frac{\mathrm{d}n_{\bf k}}{\mathrm{d}t} = St_{\bf k} + f_{\bf k} - d_{\bf k} n_{\bf k}\]</p><p>where <span>$n_{\bf k}$</span> is the wave-action spectrum, <span>$St_{\bf k}$</span> is the collisional integral, <span>$f_{\bf k}$</span> is the forcing, and <span>$d_{\bf k}$</span> the dissipation coefficient. Their definitions depend on the physical problem. See e.g. <a href="https://link.springer.com/book/10.1007/978-3-642-15942-8">Nazarenko, Springer, Volume 825 of Lecture Notes in Physics (2011)</a> for an introduction on the topic. </p><p>The WKE can be classified by the number of waves interacting, which results in different degrees of nonlinearity and integrations to be performed. In the current version of the code, we consider two types of systems that can be generically written as follows.</p><h3 id="3-waves-canonical-systems"><a class="docs-heading-anchor" href="#3-waves-canonical-systems">3-waves canonical systems</a><a id="3-waves-canonical-systems-1"></a><a class="docs-heading-anchor-permalink" href="#3-waves-canonical-systems" title="Permalink"></a></h3><p>In this case the collisional integral reads</p><p class="math-container">\[St_{\bf k}=\int (\mathcal{R}^{\bf k}_{12}-\mathcal{R}^{1}_{2 {\bf k}}-\mathcal{R}^{2}_{{\bf k}1})\mathrm{d}{\bf k}_1\mathrm{d}{\bf k}_2\]</p><p>with <span>$\mathcal{R}^{\bf k}_{12}=|V_{{\bf k}12}|^2(n_1n_2-n_1n_{\bf k}-n_{\bf k}n_2)\delta({{\bf k}-{\bf k}_1-{\bf k}_2})\delta(\omega_{\bf k}- \omega_1- \omega_2)$</span>, <span>$V_{{\bf k}12}$</span> is the interaction coefficient, and <span>$\omega_{\bf k}$</span> is the wave frequency. Systems with interactions involving more than 3 waves and/or having a noncanonical structure can be implemented as well.</p><p>Note that if wavevectors are in dimension <span>$d$</span>, then there are <span>$2d - d - 1=d-1$</span> integrals to be performed for each value of a external wavevector <span>${\bf k}$</span>. Therefore, if we use <span>$M$</span> points to discretise each coordinate of the wavevector space, then the numerical cost will be generically of the order of <span>$M^{2d -1}$</span> operations. However, assuming full isotropy or isotropy in a plane can drastically reduce the numerical cost, making calculations possible.</p><h3 id="4-waves-canonical-systems"><a class="docs-heading-anchor" href="#4-waves-canonical-systems">4-waves canonical systems</a><a id="4-waves-canonical-systems-1"></a><a class="docs-heading-anchor-permalink" href="#4-waves-canonical-systems" title="Permalink"></a></h3><p>In these systems there is one extra integral</p><p class="math-container">\[St_{\bf k}=\int |T^{{\bf k 1}}_{\bf 2 3}|^2\delta({{\bf k}+{\bf k}_1-{\bf k}_2}-{\bf k}_3)\delta(\omega^{{\bf k 1}}_{\bf 2 3}) n_{\bf k}n_{\bf 1}n_{\bf 2}n_{\bf 3}\left( \frac{1}{n_{\bf k}} + \frac{1}{n_{\bf 1}} -\frac{1}{n_{\bf 2}} -\frac{1}{n_{\bf 3}} \right)\mathrm{d}{\bf k}_1\mathrm{d}{\bf k}_2\mathrm{d}{\bf k}_2\]</p><p>with <span>$\omega^{{\bf k 1}}_{\bf 2 3}=\omega_{\bf k}+ \omega_{\bf 2}- \omega_{\bf 3}-\omega_{\bf 4}$</span> and <span>$T^{{\bf k 1}}_{\bf 2 3}$</span> the interaction coefficient.</p><p>For these systems, there are <span>$3d-d-1=2d-1$</span> integrals to be performed, which implies in general a numerical cost of the order of <span>$M^{3d-1}$</span> operations.</p><h3 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h3><p>We mostly use logarithmic grids to span larger range of scales (wavevectors). The code includes standard interpolation and integration schemes adapted to these grids. Standard time evolution schemes (Euler, RK2, RK4, and Splitting methods) with adaptative time steps are also implemented. For most physical systems, we define basic outputs (e.g. wave-action, energy, and associated fluxes), that can be saved during the simulations.</p><p>Wavkins intends to be a generic and modular solver in which new physical systems should be easily implemented, see section <a href="creating-new-solvers.html#How-to-create-a-new-solver">How to create a new solver</a>. </p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>WavKinS is still under development. Although it has been carefully tested you can use at your own digression. If you find any bug or mathematical inconsistency please report it to make this solver</p></div></div><h2 id="Physical-systems"><a class="docs-heading-anchor" href="#Physical-systems">Physical systems</a><a id="Physical-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-systems" title="Permalink"></a></h2><p>We have developed solvers for several physical systems. These solvers have been written in past and current scientific research projects for scientific purposes.</p><h3 id="Currently-available-systems"><a class="docs-heading-anchor" href="#Currently-available-systems">Currently available systems</a><a id="Currently-available-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Currently-available-systems" title="Permalink"></a></h3><ul><li><p><a href="physical_systems/Acoustic.html#Acoustic2D-solver"><code>Acoustic2D</code></a>: Isotropic two-dimensional acoustic wave turbulence.</p></li><li><p><a href="physical_systems/Acoustic.html#Acoustic3Dsolver"><code>Acoustic3D</code></a>: Isotropic three-dimensional acoustic wave turbulence. </p></li><li><p><a href="physical_systems/Bogoliubov.html#Bogoliubov3Dsolver"><code>Bogoliubov3D</code></a>: Isotropic three-dimensional Bogoliubov wave turbulence.</p></li><li><p><a href="physical_systems/MMT.html#MMT-solver"><code>MMT</code></a>: Majda-McLaughlin-Tabak model.</p></li><li><p><a href="physical_systems/NLS.html#NLS3Dsolver"><code>NLS3D</code></a>: Isotropic three dimensional non-linear Schrödinger equation.</p></li><li><p><a href="physical_systems/Petviashvilli.html#Petviashvilli_Asympsolver"><code>Petviashvilli_Asymp</code></a>: Waves systems based on the Petviashvilli equation in the strongly anisotropic limit.</p></li><li><p><a href="physical_systems/Stratified.html#Stratified_Asympsolver"><code>Stratified_Asymp</code></a>: Three-dimensional internal gravity wave turbulence in the strongly anisotropic (hydrostatic) limit. </p></li><li><p><a href="physical_systems/Smoluchowski.html#Smoluchowskisolver"><code>Smoluchowski</code></a>: Smoluchowski coagulation equation.</p></li></ul><h3 id="Under-development"><a class="docs-heading-anchor" href="#Under-development">Under development</a><a id="Under-development-1"></a><a class="docs-heading-anchor-permalink" href="#Under-development" title="Permalink"></a></h3><ul><li><p><code>Acoustic2D_kxky</code>: two-dimensional acoustic wave turbulence with anisotropic forcing and dissipation.</p></li><li><p><code>IGW_Asymp</code> : internal and inertial gravity waves in the strongly anisotropic (hydrostatic) limit. </p></li><li><p><code>IGW</code> :  non-hydrostatic internal and inertial gravity waves</p></li></ul><h2 id="Code-structure"><a class="docs-heading-anchor" href="#Code-structure">Code structure</a><a id="Code-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Code-structure" title="Permalink"></a></h2><p>The code is decomposed as follows:</p><ul><li><p><code>src</code>: Source files of the code. It is divided into several parts:</p><ul><li><code>grid</code>: Structures and functions for the grids.</li><li><code>integration</code>: Tools used for integrations, mainly for log grids. </li><li><code>interpolation</code>: Tools used for interpolations, mainly for log grids.</li><li><code>misc</code>: Miscellaneous tools, that are still not classified.</li><li><code>physical_systems</code>: Structures and necessary functions for the simulations of wave systems. We use a sub-folder for each systems, which contains: <ul><li><code>basics.jl</code>: Definitions of the frequency, interaction coefficients, resonant manifold, ...</li><li><code>collision_integral.jl</code>: Define the method <a href="physical_systems/Stratified.html#WavKinS.St_k!-Tuple{Stratified_Asymp}"><code>St_k!</code></a> for computing the collision integral. <a href="physical_systems/Stratified.html#WavKinS.St_k!-Tuple{Stratified_Asymp}"><code>St_k!</code></a> is overloaded, allowing to have the same syntax for all solvers. </li><li><code>structure.jl</code>: Structure for the run.</li><li><code>special.jl</code>: Non-standard diagnostics/functions (not for all systems). </li></ul>We give common definitions and structures, used for several wave systems, in [<code>basics_all.jl</code>]. For some wave systems, we packed several variations in the same sub-folders for consistency (e.g. <code>Acoustic</code> contains structures and definitions of isotropic and anisotropic Acoustic wave systems whose dispersion relation is the same, but not the spatial dimension and/or the forcing).</li><li><code>plot</code>: Standard <code>WavKins</code> plots. They are all made with the <a href="https://docs.makie.org/stable/"><code>Makie.jl</code></a> package, using the <code>GLMakie.jl</code> backend. #TODO: Move this part elsewhere when separated from the main code.</li><li><code>time_stepping</code>: Standard functions for time stepping.</li><li><code>WavKinS_diagnostics.jl</code>: Definitions of standard diagnostics (total wave-action, total energy, total energy dissipation, energy spectrum, wave-action fluxes, energy fluxes, ...). </li><li><code>WavKinS_outputs.jl</code>: Inputs/Outputs functions. </li><li><code>WavKinS_parameters.jl</code>: Structures for simulation parameters (output directory, which outputs, final time, ...).</li><li><code>WavKinS_partitions_threads.jl</code>: Tools for multithreading. In particular, the functions for getting partitions of nodes among threads.</li><li><code>WavKinS_structures.jl</code>: Very standard structures used in WavKins simulations (spectra, params containers, ...).</li></ul></li><li><p><code>run</code>: Run simulations and test the code.</p><ul><li><code>simple</code>: Simple simulations for various physical systems.  </li><li><code>tests</code>: Test the different parts of the code (see the folder <code>src</code>).</li></ul></li><li><p><code>postproc</code>: Example scripts (Julia, Python, and Matlab) that show how we can analyze outputs of some simulations.</p></li><li><p><code>materials</code>: Useful references and notebooks that explain the theory and some technical parts of the code.</p></li><li><p><code>docs</code>: Documentation.</p></li></ul><h2 id="Contributors"><a class="docs-heading-anchor" href="#Contributors">Contributors</a><a id="Contributors-1"></a><a class="docs-heading-anchor-permalink" href="#Contributors" title="Permalink"></a></h2><p>Main:</p><ul><li><a href="https://gkrstulovic.gitlab.io/">Giorgio Krstulovic</a> (krstulovic@oca.eu) </li><li><a href="https://scholar.google.com/citations?user=83UL2ZsAAAAJ&amp;hl=en">Vincent Labarre</a> (vincent.labarre@polytechnique.edu) </li></ul><p>Other developers:</p><ul><li><a href="https://scholar.google.fr/citations?user=N43KuycAAAAJ&amp;hl=en">Ying Zhu</a></li><li><a href="https://scholar.google.com/citations?user=iSn_fuYAAAAJ&amp;hl=fr">Guillaume Costa</a></li></ul><p>Scientific collaborators:</p><ul><li><a href="https://scholar.google.com/citations?user=EPW6UlQAAAAJ&amp;hl=en">Sergey Nazarenko</a></li><li><a href="https://jipolanco.gitlab.io/">Juan Ignacio Polanco</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="quick_start/installation.html">Installing WavKinS »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 27 November 2024 11:37">Wednesday 27 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
