<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Numerical methods · WavKinS.jl</title><meta name="title" content="Numerical methods · WavKinS.jl"/><meta property="og:title" content="Numerical methods · WavKinS.jl"/><meta property="twitter:title" content="Numerical methods · WavKinS.jl"/><meta name="description" content="Documentation for WavKinS.jl."/><meta property="og:description" content="Documentation for WavKinS.jl."/><meta property="twitter:description" content="Documentation for WavKinS.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="WavKinS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">WavKinS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><span class="tocitem">Quick start</span><ul><li><a class="tocitem" href="quick_start/installation.html">Installing WavKinS</a></li><li><a class="tocitem" href="quick_start/collisional_integral_tutorial.html">Computing a collisional integral</a></li><li><a class="tocitem" href="quick_start/running_tutorial.html">Running an example</a></li><li><a class="tocitem" href="quick_start/diagnostics_tutorial.html">Adding a diagnostic</a></li></ul></li><li><a class="tocitem" href="basics.html">Basics</a></li><li><span class="tocitem">Physical systems</span><ul><li><a class="tocitem" href="physical_systems/Acoustic.html">Acoustic</a></li><li><a class="tocitem" href="physical_systems/Bogoliubov.html">Bogoliubov</a></li><li><a class="tocitem" href="physical_systems/NLS.html">NLS</a></li><li><a class="tocitem" href="physical_systems/MMT.html">MMT</a></li><li><a class="tocitem" href="physical_systems/Petviashvilli.html">Petviashvilli</a></li><li><a class="tocitem" href="physical_systems/Smoluchowski.html">Smoluchowski</a></li><li><a class="tocitem" href="physical_systems/Stratified.html">Stratified</a></li><li><a class="tocitem" href="physical_systems/generalities.html">Generalities</a></li><li><a class="tocitem" href="physical_systems/TestTimeStepping.html">TestTimeStepping</a></li></ul></li><li class="is-active"><a class="tocitem" href="numerical-methods.html">Numerical methods</a><ul class="internal"><li><a class="tocitem" href="#Grid"><span>Grid</span></a></li><li><a class="tocitem" href="#Interpolation"><span>Interpolation</span></a></li><li><a class="tocitem" href="#Integration"><span>Integration</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time-stepping</span></a></li><li><a class="tocitem" href="#Miscellaneous"><span>Miscellaneous</span></a></li></ul></li><li><a class="tocitem" href="multithreading.html">Multithreading</a></li><li><a class="tocitem" href="plots.html">Plots</a></li><li><a class="tocitem" href="creating-new-solvers.html">Creating new solvers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="numerical-methods.html">Numerical methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="numerical-methods.html">Numerical methods</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Numerical-methods"><a class="docs-heading-anchor" href="#Numerical-methods">Numerical methods</a><a id="Numerical-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-methods" title="Permalink"></a></h1><h2 id="Grid"><a class="docs-heading-anchor" href="#Grid">Grid</a><a id="Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Grid" title="Permalink"></a></h2><p>Here are the methods used to create grids and compute related quantities.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.LogRange-Tuple{Any, Any, Any}" href="#WavKinS.LogRange-Tuple{Any, Any, Any}"><code>WavKinS.LogRange</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LogRange(kmin,kmax,M)</code></pre><p>Create <code>M</code> logarithmic grid points between <code>kmin</code> and <code>kmax</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.area_ratio-NTuple{4, Any}" href="#WavKinS.area_ratio-NTuple{4, Any}"><code>WavKinS.area_ratio</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">area_ratio(yi,yu,yl,yr)</code></pre><p>Area of a box (x,y) ∈ [xl,xr] × [<code>yi</code>,<code>yu</code>] that is below the line passing by (xl,<code>yl</code>) and (xr,<code>yr</code>), divided by the total area of the box.</p><p>Note: does not depend on xl and xr.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.area_ratio_grid-Tuple{Any, Any, Any}" href="#WavKinS.area_ratio_grid-Tuple{Any, Any, Any}"><code>WavKinS.area_ratio_grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">area_ratio_grid(x, y, f)</code></pre><p>For each cell of the grid <code>x</code> × <code>y</code>, return the area under <code>f</code> divided by the total area of the box. </p><p>Note: convolution allows to integrate over <code>y</code> &lt; <code>f</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.area_ratio_logbins-NTuple{4, Any}" href="#WavKinS.area_ratio_logbins-NTuple{4, Any}"><code>WavKinS.area_ratio_logbins</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">area_ratio_logbins(kkh, kkz, logλz, f)</code></pre><p>Same as <a href="numerical-methods.html#WavKinS.area_ratio_grid-Tuple{Any, Any, Any}"><code>area_ratio_grid</code></a> but for logarithmic grids. </p><ul><li><code>kkh</code>: horizontal wave vectors grid points</li><li><code>kkz</code>: vertical wave vectors grid points</li><li><code>logλz</code>: log(λz) where λz is the logarithmic increment of the vertical wave vectors grid</li><li><code>f</code>: values of <code>f</code> vs <code>kkh</code></li></ul><p>Note: convolution allows to integrate over <code>kkz</code> &lt; <code>f</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.change_mesh!-Tuple{Any, Any}" href="#WavKinS.change_mesh!-Tuple{Any, Any}"><code>WavKinS.change_mesh!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">change_mesh!(Nknew,Nkold;interp_scheeme=BS_interp)</code></pre><p>Fill <code>Nknew</code> wave action spectrum from interpolation <code>interp_scheeme</code> of <code>Nkold</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.meshgrid-Tuple{Any, Any}" href="#WavKinS.meshgrid-Tuple{Any, Any}"><code>WavKinS.meshgrid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">meshgrid(x, y)</code></pre><p>Create 2D grids from the 1D vectors <code>x</code> and <code>y</code>.</p></div></section></article><h2 id="Interpolation"><a class="docs-heading-anchor" href="#Interpolation">Interpolation</a><a id="Interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Interpolation" title="Permalink"></a></h2><p>In the following figure, we represent a mesh of the wave vector grid for 1D systems (left) and 2D systems (right) problem.</p><p><img src="assets/interpolation.png" alt/></p><p>For 1D systems, the <span>$i^{\rm th}$</span> mesh is <span>$\mathcal{C}_i \equiv [k_{i-1}: k_{i}]$</span> except for the first mesh which correspond to the segment <span>$\mathcal{C}_1 = [0:k_1]$</span>. We extend this definition to 2D systems as <span>$\mathcal{C}_{i_h,i_z} \equiv [k_{h,i_h-1}: k_{h,i_h}] \times [k_{z,i_z-1}: k_{z,i_z}]$</span>.</p><p>Inside each mesh, we use a given mathematical expression for interpolating the waveaction at <span>$k$</span> (or <span>$(k_h,k_z)$</span>) knowing the value of the waveaction <span>$n_{i-1} = n(k_{i-1})$</span> and <span>$n_i = n(k_i)$</span> (or <span>$n_1 = n(k_{h,i_h-1}, k_{z,i_z-1})$</span>, <span>$n_2 = n(k_{h,i_h}, k_{z,i_z-1})$</span>, <span>$n_3 = n(k_{h,i_h}, k_{z,i_z})$</span> and <span>$n_4 = n(k_{h,i_h-1}, k_{z,i_z})$</span>). This mathematical expression depends on the interpolation method.</p><div class="admonition is-category-example"><header class="admonition-header">Example</header><div class="admonition-body"><p>For using the linear interpolation method <code>lin_interp</code> with the <a href="physical_systems/Acoustic.html#WavKinS.Acoustic2D"><code>Acoustic2D</code></a> solver, you define the simulation strucure <code>Run</code> as <code>Run = Acoustic2D(Nk; interp_scheeme=WavKinS.lin_interp)</code>.</p></div></div><p>For each interpolation method, we store interpolation coefficients in stuctures that are defined in <code>src/interpolation/WavKinS_interpolation_structs.jl</code>. We compute these coefficients using the <a href="numerical-methods.html#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>update_coeff_interp!</code></a> method (one definition per interpolation method). Once the coefficients have been updated, you can compute the value of the waveaction at point <span>$k$</span> (or <span>$(k_h,k_z)$</span>) using the method <a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a>. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a> is overloaded to allow changing the interpolation scheme without changing anything in the solvers. For more informations about the interpolations methods, please refer to <a href="numerical-methods.html#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>update_coeff_interp!</code></a> documentation.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.BS_interp-Tuple{AbstractVector}" href="#WavKinS.BS_interp-Tuple{AbstractVector}"><code>WavKinS.BS_interp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BS_interp(kk::AbstractVector)</code></pre><p>Allocate nodes for BSplines interpolation. See <a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.bilin_interp_khkz-Tuple{AbstractVector, AbstractVector}" href="#WavKinS.bilin_interp_khkz-Tuple{AbstractVector, AbstractVector}"><code>WavKinS.bilin_interp_khkz</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bilin_interp_khkz(kkh::AbstractVector, kkz::AbstractVector)</code></pre><p>Allocate coefficients for bilinear interpolation and define interpolation method. See <a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.bilinlog_interp_khkz-Tuple{AbstractVector, AbstractVector}" href="#WavKinS.bilinlog_interp_khkz-Tuple{AbstractVector, AbstractVector}"><code>WavKinS.bilinlog_interp_khkz</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bilinlog_interp_khkz(kkh::AbstractVector, kkz::AbstractVector)</code></pre><p>Allocate coefficients for bilinear interpolation in log scale and define interpolation method. See <a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.cpow_interp_khkz-Tuple{AbstractVector, AbstractVector}" href="#WavKinS.cpow_interp_khkz-Tuple{AbstractVector, AbstractVector}"><code>WavKinS.cpow_interp_khkz</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cpow_interp_khkz(kkh::AbstractVector, kkz::AbstractVector)</code></pre><p>Allocate coefficients for cpow interpolation and define interpolation method. See <a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.exp_interp_khkz-Tuple{AbstractVector, AbstractVector}" href="#WavKinS.exp_interp_khkz-Tuple{AbstractVector, AbstractVector}"><code>WavKinS.exp_interp_khkz</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exp_interp_khkz(kkh::AbstractVector, kkz::AbstractVector)</code></pre><p>Allocate coefficients for exponential interpolation and define interpolation method. See <a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.lin_interp-Tuple{AbstractVector}" href="#WavKinS.lin_interp-Tuple{AbstractVector}"><code>WavKinS.lin_interp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lin_interp(kk::AbstractVector)</code></pre><p>Allocate coefficients for linear interpolation and define interpolation method. See <a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.linlog_interp-Tuple{AbstractVector}" href="#WavKinS.linlog_interp-Tuple{AbstractVector}"><code>WavKinS.linlog_interp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linlog_interp(kk::AbstractVector)</code></pre><p>Allocate coefficients for linear interpolation in log scale (power law) and define interpolation method. See <a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.powGauss_interp-Tuple{AbstractVector}" href="#WavKinS.powGauss_interp-Tuple{AbstractVector}"><code>WavKinS.powGauss_interp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">powGauss_interp(kk::AbstractVector)</code></pre><p>Allocate coefficients for power-law Gaussian interpolation. See <a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.powexp_interp-Tuple{AbstractVector}" href="#WavKinS.powexp_interp-Tuple{AbstractVector}"><code>WavKinS.powexp_interp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">powexp_interp(kk::AbstractVector)</code></pre><p>Allocate coefficients for power-law exponential interpolation. See <a href="numerical-methods.html#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>val_nk</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.bilin_interp_vs-NTuple{10, Any}" href="#WavKinS.bilin_interp_vs-NTuple{10, Any}"><code>WavKinS.bilin_interp_vs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bilin_interp_vs(kh,kz,khinf,khsup,kzinf,kzsup,n1,n2,n3,n4)</code></pre><p>Return the bilinear interpolation of <span>$n_{\bf k}$</span> at point (<code>kh</code>,<code>kz</code>) computed using the points (<code>khinf</code>,<code>kzinf</code>,<code>n1</code>), (<code>khsup</code>,<code>kzinf</code>,<code>n2</code>), (<code>khsup</code>,<code>kzsup</code>,<code>n3</code>) and (<code>khinf</code>,<code>kzsup</code>,<code>n4</code>).</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.lin_interp_vs-NTuple{5, Any}" href="#WavKinS.lin_interp_vs-NTuple{5, Any}"><code>WavKinS.lin_interp_vs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lin_interp_vs(k,k1,k2,n1,n2)</code></pre><p>Return the linear interpolation of <span>$n_k$</span> at point <code>k</code> computed using the points <code>(k1,n1)</code> and <code>(k2,n2)</code></p><p><span>$n_k = n_1 \frac{k_2-k}{k_2-k_1} + n_2 \frac{k-k_1}{k_2-k_1}.$</span> </p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}" href="#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>WavKinS.update_coeff_interp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_coeff_interp!(interp::BS_interp,Nk::wave_spectrum)</code></pre><p>Compute the coefficients for B-spline interpolation. The method is given by the <a href="https://jipolanco.github.io/BSplineKit.jl/dev/">BSplineKit</a> package.</p><ul><li><code>Nk</code>: Structure containing the wave action wave_spectrum</li><li><code>interp</code>: structure where the coefficients are stored</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.update_coeff_interp!-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz}" href="#WavKinS.update_coeff_interp!-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz}"><code>WavKinS.update_coeff_interp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_coeff_interp!(::bilin_interp_khkz, Nk::wave_spectrum_khkz)</code></pre><p>Compute the coefficients <span>$C_0$</span>, <span>$\alpha_h$</span>, <span>$\alpha_z$</span> and <span>$\beta$</span> for bilinear interpolation such that <span>$n_{\bf k} = C_0 - \alpha_h k_h - \alpha_z k_z - \beta k_h k_z$</span>.</p><ul><li><code>Nk</code>: Structure containing the wave action wave_spectrum</li><li><code>interp</code>: structure where the coefficients are stored</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.update_coeff_interp!-Tuple{WavKinS.bilinlog_interp_khkz, wave_spectrum_khkz}" href="#WavKinS.update_coeff_interp!-Tuple{WavKinS.bilinlog_interp_khkz, wave_spectrum_khkz}"><code>WavKinS.update_coeff_interp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_coeff_interp!(::bilinlog_interp_khkz, Nk::wave_spectrum_khkz)</code></pre><p>Compute the coefficients <span>$C_0$</span>, <span>$\alpha_h$</span>, <span>$\alpha_z$</span> and <span>$\beta$</span> for bilinear interpolation in logarithmic scale (power law) such that <span>$n_{\bf k} = e^{C_0 - \alpha_h \log k_h - \alpha_z \log k_z - \beta \log k_h \log k_z}$</span>.</p><ul><li><code>Nk</code>: Structure containing the wave action wave_spectrum</li><li><code>interp</code>: structure where the coefficients are stored</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.update_coeff_interp!-Tuple{WavKinS.cpow_interp_khkz, wave_spectrum_khkz}" href="#WavKinS.update_coeff_interp!-Tuple{WavKinS.cpow_interp_khkz, wave_spectrum_khkz}"><code>WavKinS.update_coeff_interp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_coeff_interp!(::cpow_interp_khkz, Nk::wave_spectrum_khkz)</code></pre><p>Compute the coefficients <span>$C_0$</span>, <span>$\alpha_h$</span>, <span>$\alpha_z$</span> and <span>$\beta$</span> for bilinear interpolation such that <span>$n_{\bf k} = \beta + C_0  k_h^{-\alpha_h} k_z^{-\alpha_z k_z}$</span>.</p><ul><li><code>Nk</code>: Structure containing the wave action wave_spectrum</li><li><code>interp</code>: structure where the coefficients are stored</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.update_coeff_interp!-Tuple{WavKinS.exp_interp_khkz, wave_spectrum_khkz}" href="#WavKinS.update_coeff_interp!-Tuple{WavKinS.exp_interp_khkz, wave_spectrum_khkz}"><code>WavKinS.update_coeff_interp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_coeff_interp!(::exp_interp_khkz, Nk::wave_spectrum_khkz)</code></pre><p>Compute the coefficients <span>$C_0$</span>, <span>$\alpha_h$</span>, <span>$\alpha_z$</span> and <span>$\beta$</span> for exponential interpolation such that <span>$n_{\bf k} = e^{C_0 - \alpha_h k_h - \alpha_z k_z - \beta k_h k_z}$</span>.</p><ul><li><code>Nk</code>: Structure containing the wave action wave_spectrum</li><li><code>interp</code>: structure where the coefficients are stored</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.update_coeff_interp!-Tuple{WavKinS.lin_interp, wave_spectrum}" href="#WavKinS.update_coeff_interp!-Tuple{WavKinS.lin_interp, wave_spectrum}"><code>WavKinS.update_coeff_interp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_coeff_interp!(::lin_interp,Nk::wave_spectrum)</code></pre><p>Compute the coefficients <span>$\alpha$</span> and <span>$\beta$</span> for linear interpolation such that <span>$n_{\bf k} = \alpha + \beta k$</span>.</p><ul><li><code>Nk</code>: Structure containing the wave action wave_spectrum</li><li><code>interp</code>: structure where the coefficients are stored</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.update_coeff_interp!-Tuple{WavKinS.linlog_interp, wave_spectrum}" href="#WavKinS.update_coeff_interp!-Tuple{WavKinS.linlog_interp, wave_spectrum}"><code>WavKinS.update_coeff_interp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_coeff_interp!(::linlog_interp,Nk::wave_spectrum)</code></pre><p>Compute the coefficients <span>$\alpha$</span> and <span>$C_0$</span> for linear interpolation in logarithmic scale (power law) such that <span>$n_{\bf k} = C_0 k^{-\alpha} = C_0 e^{- \alpha \log k}$</span>.</p><ul><li><code>Nk</code>: Structure containing the wave action wave_spectrum</li><li><code>interp</code>: structure where the coefficients are stored</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.update_coeff_interp!-Tuple{WavKinS.powGauss_interp, wave_spectrum}" href="#WavKinS.update_coeff_interp!-Tuple{WavKinS.powGauss_interp, wave_spectrum}"><code>WavKinS.update_coeff_interp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_coeff_interp!(::powexp_interp,Nk::wave_spectrum)</code></pre><p>Compute the coefficients <span>$C_0$</span>, <span>$\alpha$</span> and <span>$\beta$</span> for power law Gaussian interpolation such that <span>$n_{\bf k} = C_0 k^{-\alpha} e^{-\beta k^2}$</span>.</p><ul><li><code>Nk</code>: Structure containing the wave action wave_spectrum</li><li><code>interp</code>: structure where the coefficients are stored</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.update_coeff_interp!-Tuple{WavKinS.powexp_interp, wave_spectrum}" href="#WavKinS.update_coeff_interp!-Tuple{WavKinS.powexp_interp, wave_spectrum}"><code>WavKinS.update_coeff_interp!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_coeff_interp!(::powexp_interp,Nk::wave_spectrum)</code></pre><p>Compute the coefficients <span>$C_0$</span>, <span>$\alpha$</span> and <span>$\beta$</span> for power law exponential interpolation such that <span>$n_{\bf k} = C_0 k^{-\alpha} e^{-\beta k}$</span>.</p><ul><li><code>Nk</code>: Structure containing the wave action wave_spectrum</li><li><code>interp</code>: structure where the coefficients are stored</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}" href="#WavKinS.val_nk-Tuple{WavKinS.bilin_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>WavKinS.val_nk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">val_nk(::bilin_interp_khkz, Nk::wave_spectrum_khkz, kh, kz)</code></pre><p>Return the value of <code>Nk.nk</code> interpolated at (<code>kh</code>, <code>kz</code>) (with <code>bilin_interp_khkz</code>). Coefficients should be updated.</p><p>See also <a href="numerical-methods.html#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>update_coeff_interp!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.val_nk-Tuple{WavKinS.bilinlog_interp_khkz, wave_spectrum_khkz, Any, Any}" href="#WavKinS.val_nk-Tuple{WavKinS.bilinlog_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>WavKinS.val_nk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">val_nk(::bilinlog_interp_khkz, Nk::wave_spectrum_khkz, kh, kz)</code></pre><p>Return the value of <code>Nk.nk</code> interpolated at (<code>kh</code>, <code>kz</code>) (with <code>bilinlog_interp_khkz</code>). Coefficients should be updated.</p><p>See also <a href="numerical-methods.html#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>update_coeff_interp!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.val_nk-Tuple{WavKinS.cpow_interp_khkz, wave_spectrum_khkz, Any, Any}" href="#WavKinS.val_nk-Tuple{WavKinS.cpow_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>WavKinS.val_nk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">val_nk(::cpow_interp_khkz, Nk::wave_spectrum_khkz, kh, kz)</code></pre><p>Return the value of <code>Nk.nk</code> interpolated at (<code>kh</code>, <code>kz</code>) (with <code>cpow_interp_khkz</code>). Coefficients should be updated.</p><p>See also <a href="numerical-methods.html#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>update_coeff_interp!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.val_nk-Tuple{WavKinS.exp_interp_khkz, wave_spectrum_khkz, Any, Any}" href="#WavKinS.val_nk-Tuple{WavKinS.exp_interp_khkz, wave_spectrum_khkz, Any, Any}"><code>WavKinS.val_nk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">val_nk(::exp_interp_khkz, Nk::wave_spectrum_khkz, kh, kz)</code></pre><p>Return the value of <code>Nk.nk</code> interpolated at (<code>kh</code>, <code>kz</code>) (with <code>exp_interp_khkz</code>). Coefficients should be updated.</p><p>See also <a href="numerical-methods.html#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>update_coeff_interp!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.val_nk-Tuple{WavKinS.lin_interp, wave_spectrum, Any}" href="#WavKinS.val_nk-Tuple{WavKinS.lin_interp, wave_spectrum, Any}"><code>WavKinS.val_nk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">val_nk(::lin_interp,Nk::waveaction,k)</code></pre><p>Return the value of <code>Nk.nk</code> interpolated at <code>k</code> (with <code>lin_interp</code>). Coefficients should be updated.</p><p>See also <a href="numerical-methods.html#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>update_coeff_interp!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.val_nk-Tuple{WavKinS.linlog_interp, wave_spectrum, Any}" href="#WavKinS.val_nk-Tuple{WavKinS.linlog_interp, wave_spectrum, Any}"><code>WavKinS.val_nk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">val_nk(::linlog_interp,Nk::waveaction,k)</code></pre><p>Return the value of <code>Nk.nk</code> interpolated at <code>k</code> (with <code>linlog_interp</code>). Coefficients should be updated.</p><p>See also <a href="numerical-methods.html#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>update_coeff_interp!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.val_nk-Tuple{WavKinS.powGauss_interp, wave_spectrum, Any}" href="#WavKinS.val_nk-Tuple{WavKinS.powGauss_interp, wave_spectrum, Any}"><code>WavKinS.val_nk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">val_nk(interp::powGauss_interp, Nk::wave_spectrum, k)</code></pre><p>Return the value of <code>Nk.nk</code> interpolated at <code>k</code> (with <code>powGauss_interp</code>). Coefficients should be updated.</p><p>See also <a href="numerical-methods.html#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>update_coeff_interp!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.val_nk-Tuple{WavKinS.powexp_interp, wave_spectrum, Any}" href="#WavKinS.val_nk-Tuple{WavKinS.powexp_interp, wave_spectrum, Any}"><code>WavKinS.val_nk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">val_nk(::powexp_interp,Nk::waveaction,k)</code></pre><p>Return the value of <code>Nk.nk</code> interpolated at <code>k</code> (with <code>powexp_interp</code>). Coefficients should be updated.</p><p>See also <a href="numerical-methods.html#WavKinS.update_coeff_interp!-Tuple{WavKinS.BS_interp, wave_spectrum}"><code>update_coeff_interp!</code></a></p></div></section></article><h2 id="Integration"><a class="docs-heading-anchor" href="#Integration">Integration</a><a id="Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Integration" title="Permalink"></a></h2><p>Like for <a href="numerical-methods.html#Interpolation">&quot;interpolation&quot;</a>, you can choose an integration method (independently). Integration are performed by summing over meshes using the <a href="numerical-methods.html#WavKinS.integrate"><code>integrate</code></a> method (one definition per interpolation method).  </p><div class="admonition is-category-example"><header class="admonition-header">Example</header><div class="admonition-body"><p>For using the integration method <code>integrate_with_log_bins</code> to integrate <code>Nk.nk</code> over meshes <code>imin</code> to <code>imax</code>, you use <code>integrate(integrate_with_log_bins, Nk, imin, imax)</code>. Note that <code>integrate(integrate_with_log_bins, Nk, i, i)</code> return the integral over mesh <code>i</code> only (i.e. between <span>$k_{i-1}$</span> and <span>$k_i$</span>).</p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><a href="numerical-methods.html#WavKinS.integrate"><code>integrate</code></a> is overloaded to allow changing the integration scheme without changing anything in the solvers. For more informations about the integrations methods, please refer to <a href="numerical-methods.html#WavKinS.integrate"><code>integrate</code></a> documentation.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate_with_cpow_khkz" href="#WavKinS.integrate_with_cpow_khkz"><code>WavKinS.integrate_with_cpow_khkz</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_with_cpow_khkz()</code></pre><p>Select the use of the cpow integration with log bins khkz method. See <a href="numerical-methods.html#WavKinS.integrate"><code>integrate</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate_with_log_bins_khkz" href="#WavKinS.integrate_with_log_bins_khkz"><code>WavKinS.integrate_with_log_bins_khkz</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_with_log_bins_khkz()</code></pre><p>Select the use of the trapezoidal integration with log bins khkz method. See <a href="numerical-methods.html#WavKinS.integrate"><code>integrate</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.clean_waveaction!-Tuple{Union{wave_spectrum, wave_spectrum_khkz}}" href="#WavKinS.clean_waveaction!-Tuple{Union{wave_spectrum, wave_spectrum_khkz}}"><code>WavKinS.clean_waveaction!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">clean_waveaction!(Nk::waveaction)</code></pre><p>Set the minimum of the waveaction spectrum <code>Nk.nk</code> to <code>min_nk</code>. By default <code>min_nk=0</code> so it removes negative values.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.cumintegrate!-Tuple{AbstractVector, Int64, Float64, Float64, Vector{Float64}, Vector{Float64}}" href="#WavKinS.cumintegrate!-Tuple{AbstractVector, Int64, Float64, Float64, Vector{Float64}, Vector{Float64}}"><code>WavKinS.cumintegrate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cumintegrate!(CumInt::AbstractVector, M::Int, λ::Float64, logλ::Float64, kk::Vector{Float64}, F::Vector{Float64})</code></pre><p>Compute cumulative integral of <code>F</code> using log bins and trapezoidal rule. The result is stored in <code>CumInt</code>.</p><ul><li><code>M</code>: number of grid points</li><li><code>λ</code>: logarithmic increment of the grid</li><li><code>logλ</code>: log(λ)</li><li><code>kk</code>: grid </li></ul><p>See also <a href="numerical-methods.html#WavKinS.integrate_with_log_bins"><code>integrate_with_log_bins</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.cumintegrate!-Tuple{AbstractVector, wave_spectrum}" href="#WavKinS.cumintegrate!-Tuple{AbstractVector, wave_spectrum}"><code>WavKinS.cumintegrate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cumintegrate!(CumInt::AbstractVector, Sk::wave_spectrum)</code></pre><p>Compute cumulative integral of <code>Sk.Nk</code> using log bins and trapezoidal rule. The result is stored in <code>CumInt</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.cumintegraterev!-Tuple{AbstractVector, Int64, Float64, Float64, Vector{Float64}, Vector{Float64}}" href="#WavKinS.cumintegraterev!-Tuple{AbstractVector, Int64, Float64, Float64, Vector{Float64}, Vector{Float64}}"><code>WavKinS.cumintegraterev!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cumintegraterev!(CumInt::AbstractVector, M::Int, λ::Float64, logλ::Float64, kk::Vector{Float64}, F::Vector{Float64})</code></pre><p>Compute cumulative integral using log bins in reverse order.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.cumintegraterev!-Tuple{AbstractVector, wave_spectrum}" href="#WavKinS.cumintegraterev!-Tuple{AbstractVector, wave_spectrum}"><code>WavKinS.cumintegraterev!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cumintegraterev!(CumInt::AbstractVector, Sk::wave_spectrum)</code></pre><p>Compute cumulative integral using log bins in reverse order.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate" href="#WavKinS.integrate"><code>WavKinS.integrate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate(Nk::wave_spectrum, imin::Int=1, imax::Int=-1)</code></pre><p>Return the integral of <code>Nk.nk</code> using (simple) trapezoidal rule from index <code>imin</code> to <code>imax</code>.  By default, it integrates over the whole domain.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate" href="#WavKinS.integrate"><code>WavKinS.integrate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_with_grid(Sk::field_grid_1D, imin::Int=1, imax::Int=-1)</code></pre><p>Return the integral of <code>Sk.F</code> using (simple) trapezoidal rule on grid <code>Sk.kk</code> between index <code>imin</code> and <code>imax</code>. </p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate" href="#WavKinS.integrate"><code>WavKinS.integrate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate(integ::integrate_with_cpow_khkz, Nk::wave_spectrum_khkz, ihmin::Int=1, ihmax::Int=-1, izmin::Int=1, izmax::Int=-1)</code></pre><p>Return the integral of <code>Nk.nk</code> assuming <span>$n_{\bf k} = \beta + C_0  k_h^{-\alpha_h} k_z^{-\alpha_z k_z}$</span> in each mesh from index <code>ihmin</code> to <code>ihmax</code> and <code>izmin</code> to <code>izmax</code>.  By default, it integrates over the whole domain.</p><p>See also <code>cpow_interp_khkz</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate" href="#WavKinS.integrate"><code>WavKinS.integrate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate(integ::integrate_with_log_bins_khkz, Nk::wave_spectrum_khkz, ihmin::Int=1, ihmax::Int=-1, izmin::Int=1, izmax::Int=-1)</code></pre><p>Return the integral of <code>Nk.nk</code> using log bins and trapezoidal rule from index <code>ihmin</code> to <code>ihmax</code> and <code>izmin</code> to <code>izmax</code>.  By default, it integrates over the whole domain.</p><p>Namely <span>$I = \int\limits_{k_{h{\rm min}}}^{k_{h{\rm max}}} \int\limits_{k_{z{\rm min}}}^{k_{z{\rm max}}} ~ F(k_h,k_z) ~ \mathrm{d}k_h \mathrm{d}k_z = \int\limits_{i_{h{\rm min}}}^{i_{h{\rm max}}} \int\limits_{i_{z{\rm min}}}^{i_{z{\rm max}}} ~ F(k_h=\lambda_h^{i_h}, k_z=\lambda_z^{i_z}) ~ \lambda_h^{i_h} \lambda_z^{i_z} \ln \lambda_h \ln \lambda_z ~ \mathrm{d} i_h \mathrm{d} i_z$</span>. </p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate_quad_with_log_bins" href="#WavKinS.integrate_quad_with_log_bins"><code>WavKinS.integrate_quad_with_log_bins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_quad_with_log_bins(Nk::wave_spectrum, imin::Int=1, imax::Int=-1)</code></pre><p>Return the integral of <code>Nk.nk</code> using log bins and Simpson rule from index <code>imin</code> to <code>imax</code>.  By default, it integrates over the whole domain.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate_with_grid" href="#WavKinS.integrate_with_grid"><code>WavKinS.integrate_with_grid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_with_grid(x, F, imin::Int=1, imax::Int=-1)</code></pre><p>Return the integral of <code>F</code> using (simple) trapezoidal rule on grid <code>x</code> between index <code>imin</code> and <code>imax</code>. </p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate_with_log_bins" href="#WavKinS.integrate_with_log_bins"><code>WavKinS.integrate_with_log_bins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_with_log_bins(Nk::wave_spectrum, imin::Int=1, imax::Int=-1)</code></pre><p>Return the integral of <code>Nk.nk</code> using log bins and trapezoidal rule from index <code>imin</code> to <code>imax</code>. By default, it integrates over the whole domain.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate_with_log_bins" href="#WavKinS.integrate_with_log_bins"><code>WavKinS.integrate_with_log_bins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_with_log_bins(M::Int, λ::Float64, logλ::Float64, kk::Vector{Float64}, F::Vector{Float64}, imin::Int=1, imax::Int=-1)</code></pre><p>Return the integral of <code>F</code> using log bins and trapezoidal rule from index <code>imin</code> to <code>imax</code>.</p><ul><li><code>M</code>: number of grid points</li><li><code>λ</code>: logarithmic increment of the grid</li><li><code>logλ</code>: log(λ)</li><li><code>kk</code>: grid </li></ul><p>By default, it integrates over the whole domain. Namely <span>$I = \int\limits_{k_{\rm min}}^{k_{\rm max}} ~ F(k) ~ \mathrm{d}k = \int\limits_{i_{\rm min}}^{i_{\rm max}} ~ F(k=\lambda^{i} ) \lambda^{i} \ln \lambda ~ \mathrm{d} i$</span>. It uses trapezoidal rule.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.integrate_with_log_bins_segment-NTuple{4, Any}" href="#WavKinS.integrate_with_log_bins_segment-NTuple{4, Any}"><code>WavKinS.integrate_with_log_bins_segment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_with_log_bins_segment(Fa, Fb, ka, kb)</code></pre><p>Return the integral of <code>F</code> using trapezoidal log bins from <code>ka</code> to <code>kb</code>. </p><ul><li><code>Fa</code>: value of <code>F</code> at <code>ka</code></li><li><code>Fb</code>: value of <code>F</code> at <code>kb</code></li></ul></div></section></article><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time-stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><p>You can choose between several time stepping methods. Time advancement is done with the <a href="numerical-methods.html#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>advance!</code></a> method (one definition per time-stepping method).  </p><div class="admonition is-category-example"><header class="admonition-header">Example</header><div class="admonition-body"><p>For using the time stepping method <code>ETD4_step</code> to advance time of <code>dt</code>, you use <code>advance!(ETD4_step, Run, dt)</code>. </p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><a href="numerical-methods.html#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>advance!</code></a> is overloaded to allow changing the time stepping scheme without changing anything in the solvers. For more informations about the integrations methods, please refer to <a href="numerical-methods.html#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>advance!</code></a> documentation.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.AB2_RK2_step" href="#WavKinS.AB2_RK2_step"><code>WavKinS.AB2_RK2_step</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AB2_RK2_step()</code></pre><p>Set the use of split Second-order-Exponential-Adams-Bashforth and Runge-Kutta 2. See <a href="numerical-methods.html#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>advance!</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.AB2_RK2arrays" href="#WavKinS.AB2_RK2arrays"><code>WavKinS.AB2_RK2arrays</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AB2_RK2arrays</code></pre><p>Structure for split Second-order-Exponential-Adams-Bashforth and Runge-Kutta 2</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.AB_Euler_step" href="#WavKinS.AB_Euler_step"><code>WavKinS.AB_Euler_step</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AB_Euler_step()</code></pre><p>Set the use of split Exponential-Adams-Bashforth and Euler. See <a href="numerical-methods.html#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>advance!</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.ETD2_step" href="#WavKinS.ETD2_step"><code>WavKinS.ETD2_step</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ETD2_step()</code></pre><p>Set the use of ETD2. See <a href="numerical-methods.html#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>advance!</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.ETD2arrays" href="#WavKinS.ETD2arrays"><code>WavKinS.ETD2arrays</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ETD2arrays</code></pre><p>Structure for ETD2 </p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.ETD4_step" href="#WavKinS.ETD4_step"><code>WavKinS.ETD4_step</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ETD4_step()</code></pre><p>Set the use of ETD4. See <a href="numerical-methods.html#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>advance!</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.ETD4arrays" href="#WavKinS.ETD4arrays"><code>WavKinS.ETD4arrays</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ETD4arrays</code></pre><p>Structure for ETD4 </p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.Euler_step" href="#WavKinS.Euler_step"><code>WavKinS.Euler_step</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Euler_step()</code></pre><p>Set the use of a simple Euler. See <a href="numerical-methods.html#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>advance!</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.RK2_step" href="#WavKinS.RK2_step"><code>WavKinS.RK2_step</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RK2_step()</code></pre><p>Set the use of a Runge-Kutta 2. See <a href="numerical-methods.html#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>advance!</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.RK2arrays" href="#WavKinS.RK2arrays"><code>WavKinS.RK2arrays</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RK2arrays</code></pre><p>Structure for standard Runge-Kutta 2</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.RK4_step" href="#WavKinS.RK4_step"><code>WavKinS.RK4_step</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RK4_step()</code></pre><p>Set the use of 4th-order Runge-Kutta 4, no forcing nor dissipation. See <a href="numerical-methods.html#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>advance!</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.RK4arrays" href="#WavKinS.RK4arrays"><code>WavKinS.RK4arrays</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RK4arrays</code></pre><p>Structure for standard Runge-Kutta 4, no forcing nor dissipation</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.adaptative_time_step" href="#WavKinS.adaptative_time_step"><code>WavKinS.adaptative_time_step</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">adaptative_time_step(Run, dtmin, dtmax, dt, cmin=0.05, cmax=0.5)</code></pre><p>Return the adaptated time step based on the wave action spectrum.  </p><ul><li><code>Run</code>: run structure.   </li><li><code>dtmin</code>: minimal time step.   </li><li><code>dtmax</code>: maximal time step.   </li><li><code>dt</code>: current time step.   </li><li><code>cmin</code>: lower threshold for the ratio of the nonlinear time step and current time step.    </li><li><code>cmax</code>: upper threshold for the ratio of the nonlinear time step and current time step.  </li></ul><p>See also <a href="numerical-methods.html#WavKinS.get_T_nonlinear-Tuple{Any}"><code>get_T_nonlinear</code></a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This adaptative time step may not work for wave action that decrease very quickly.</p></div></div></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.advance!-Tuple{Euler_step, Any, Any}" href="#WavKinS.advance!-Tuple{Euler_step, Any, Any}"><code>WavKinS.advance!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">advance!(::Euler_step, Run, dt)</code></pre><p>Make one time step with <code>Euler_step</code>.</p><ul><li><code>Run</code>: run structure</li><li><code>dt</code>: time step</li></ul><p>The time advancement is simply <span>$n_{\bf k}(t+\mathrm{d}t) = \left[ St_{\rm k} + f_{\bf k} - d_{\bf k} n_{\bf k} \right] ~ \mathrm{d}t$</span>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.advance!-Tuple{RK2_step, Any, Any}" href="#WavKinS.advance!-Tuple{RK2_step, Any, Any}"><code>WavKinS.advance!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">advance!(::RK2_step, Run, dt)</code></pre><p>Make one time step with <code>RK2_step</code>.</p><ul><li><code>Run</code>: run structure</li><li><code>dt</code>: time step</li></ul><p>The time advancement is done with Runge-Kutta 2 method.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.advance!-Tuple{RK4_step, Any, Any}" href="#WavKinS.advance!-Tuple{RK4_step, Any, Any}"><code>WavKinS.advance!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">advance!(::RK4_step, Run, dt)</code></pre><p>Make one time step with <code>RK4_step</code>.</p><ul><li><code>Run</code>: run structure</li><li><code>dt</code>: time step</li></ul><p>The time advancement is done with Runge-Kutta 4 method.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.advance!-Tuple{WavKinS.AB2_RK2_step, Any, Any}" href="#WavKinS.advance!-Tuple{WavKinS.AB2_RK2_step, Any, Any}"><code>WavKinS.advance!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">advance!(::AB2_RK2_step, Run, dt)</code></pre><p>Make one time step with <code>AB2_RK2_step</code>.</p><ul><li><code>Run</code>: run structure</li><li><code>dt</code>: time step</li></ul><p>The collision integral is decomposed as <span>$St_{\bf k} = - \gamma_{\bf k} n_{\bf k} + \eta_{\bf k}$</span>. Time advancement is done with a splitting method, treating the term <span>$-(\gamma_{\bf k} + d_{\bf k}) n_{\bf k}$</span> implicitly and the term <span>$\eta_{\bf k} + f_{\bf k}$</span> explicitly with Runge-Kutta 2 method.</p><p>Note: The <code>Run</code> structure must have the coefficients <span>$\gamma_{\bf k}$</span> and <span>$\eta_{\bf k}$</span> that must be computed in <code>St_k!</code>. This scheeme is not implemented for all physical systems.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.advance!-Tuple{WavKinS.AB_Euler_step, Any, Any}" href="#WavKinS.advance!-Tuple{WavKinS.AB_Euler_step, Any, Any}"><code>WavKinS.advance!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">advance!(::AB_Euler_step, Run, dt)</code></pre><p>Make one time step with <code>AB_Euler_step</code>.</p><ul><li><code>Run</code>: run structure</li><li><code>dt</code>: time step</li></ul><p>The collision integral is decomposed as <span>$St_{\bf k} = - \gamma_{\bf k} n_{\bf k} + \eta_{\bf k}$</span>. Time advancement is done with a splitting method, treating the term <span>$-(\gamma_{\bf k} + d_{\bf k}) n_{\bf k}$</span> implicitly and the term <span>$\eta_{\bf k} + f_{\bf k}$</span> explicitly with Euler method.</p><p>Note: The <code>Run</code> structure must have the coefficients <span>$\gamma_{\bf k}$</span> and <span>$\eta_{\bf k}$</span> that must be computed in <code>St_k!</code>. This scheeme is not implemented for all physical systems.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.advance!-Tuple{WavKinS.ETD2_step, Any, Any}" href="#WavKinS.advance!-Tuple{WavKinS.ETD2_step, Any, Any}"><code>WavKinS.advance!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">advance!(::ETD2_step, Run, dt)</code></pre><p>Make one time step with <code>ETD2_step</code>.</p><ul><li><code>Run</code>: run structure</li><li><code>dt</code>: time step</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.advance!-Tuple{WavKinS.ETD4_step, Any, Any}" href="#WavKinS.advance!-Tuple{WavKinS.ETD4_step, Any, Any}"><code>WavKinS.advance!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">advance!(::ETD4_step, Run, dt)</code></pre><p>Make one time step with <code>ETD4_step</code>.</p><ul><li><code>Run</code>: run structure</li><li><code>dt</code>: time step</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.get_T_nonlinear-Tuple{Any}" href="#WavKinS.get_T_nonlinear-Tuple{Any}"><code>WavKinS.get_T_nonlinear</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_T_nonlinear(Run)</code></pre><p>Non linear time based on the wave action spectrum</p><p><span>$\tau_{\rm nl} = \frac{1}{\max\limits_{\bf k} \left| \frac{St_{\bf k}}{n_{\bf k}} \right| }.$</span></p><p>We use only the energetic modes with <span>$n_{\bf k} &gt; 10^{-50}$</span>.</p><p>Note: We use <span>$\tau_{\rm nl}$</span> to fix the adaptative time step (see <a href="numerical-methods.html#WavKinS.adaptative_time_step"><code>adaptative_time_step</code></a>). </p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.init_temporal_scheeme!-Tuple{Euler_step, Any, Any}" href="#WavKinS.init_temporal_scheeme!-Tuple{Euler_step, Any, Any}"><code>WavKinS.init_temporal_scheeme!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_temporal_scheeme!(::Euler_step, Run, dt)</code></pre><p>Initialization of the temporal scheeme.</p><ul><li>First argument is the time-stepping method: <code>Euler_step</code>, <code>AB_Euler_step</code>, <code>AB2_RK2_step</code>, <code>RK2_step</code>, <code>ETD2_step</code>, <code>RK4_step</code>, <code>ETD4_step</code>.</li><li><code>Run</code>: run structure</li><li><code>dt</code>: time step</li></ul></div></section></article><h2 id="Miscellaneous"><a class="docs-heading-anchor" href="#Miscellaneous">Miscellaneous</a><a id="Miscellaneous-1"></a><a class="docs-heading-anchor-permalink" href="#Miscellaneous" title="Permalink"></a></h2><p>Unclassified numerical methods.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.NewtonRaphson-Tuple{Any, Any}" href="#WavKinS.NewtonRaphson-Tuple{Any, Any}"><code>WavKinS.NewtonRaphson</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NewtonRaphson(f, x0; ϵ=1e-9, tol=1e-12, maxIter = 1000)</code></pre><p>Find the zero of the function <code>f</code> using the Newton-Raphson algorithm. </p><ul><li><code>x0</code>: starting point</li><li><code>ϵ</code>: spacing used to estimate derivative</li><li><code>tol</code>: tolerence</li><li><code>maxIter</code>: maximal number of iterations</li></ul><p>Adapted from <a href="https://www.matecdev.com/posts/julia-newton-raphson.html#newton-raphson-method">here</a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.NewtonRaphson_with_derivative-Tuple{Any, Any, Any}" href="#WavKinS.NewtonRaphson_with_derivative-Tuple{Any, Any, Any}"><code>WavKinS.NewtonRaphson_with_derivative</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NewtonRaphson_with_derivative(f, fp, x0, tol=1e-12, maxIter = 1000)</code></pre><p>Same as <a href="numerical-methods.html#WavKinS.NewtonRaphson-Tuple{Any, Any}"><code>NewtonRaphson</code></a>, but using the explicit derivative of <code>f</code>, which is the argument <code>fp</code>, instead of a numerical estimate.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.cardano-Tuple{Float64, Float64}" href="#WavKinS.cardano-Tuple{Float64, Float64}"><code>WavKinS.cardano</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cardano(p::Float64, q::Float64)</code></pre><p>Assuming that <code>p</code> &gt; 0 and <code>q</code> &lt; 0, it returns the positive real root of <span>$x^3 +$</span> <code>p</code> <span>$x +$</span> <code>q</code>. </p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="physical_systems/TestTimeStepping.html">« TestTimeStepping</a><a class="docs-footer-nextpage" href="multithreading.html">Multithreading »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 27 November 2024 11:14">Wednesday 27 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
