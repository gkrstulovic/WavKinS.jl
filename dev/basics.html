<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basics · WavKinS.jl</title><meta name="title" content="Basics · WavKinS.jl"/><meta property="og:title" content="Basics · WavKinS.jl"/><meta property="twitter:title" content="Basics · WavKinS.jl"/><meta name="description" content="Documentation for WavKinS.jl."/><meta property="og:description" content="Documentation for WavKinS.jl."/><meta property="twitter:description" content="Documentation for WavKinS.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="WavKinS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">WavKinS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><span class="tocitem">Quick start</span><ul><li><a class="tocitem" href="quick_start/installation.html">Installing WavKinS</a></li><li><a class="tocitem" href="quick_start/collisional_integral_tutorial.html">Computing a collisional integral</a></li><li><a class="tocitem" href="quick_start/running_tutorial.html">Running an example</a></li><li><a class="tocitem" href="quick_start/diagnostics_tutorial.html">Adding a diagnostic</a></li></ul></li><li class="is-active"><a class="tocitem" href="basics.html">Basics</a><ul class="internal"><li><a class="tocitem" href="#Structures"><span>Structures</span></a></li><li><a class="tocitem" href="#Parameters"><span>Parameters</span></a></li><li><a class="tocitem" href="#Diagnostics"><span>Diagnostics</span></a></li><li><a class="tocitem" href="#Outputs"><span>Outputs</span></a></li></ul></li><li><span class="tocitem">Physical systems</span><ul><li><a class="tocitem" href="physical_systems/Acoustic.html">Acoustic</a></li><li><a class="tocitem" href="physical_systems/Bogoliubov.html">Bogoliubov</a></li><li><a class="tocitem" href="physical_systems/NLS.html">NLS</a></li><li><a class="tocitem" href="physical_systems/MMT.html">MMT</a></li><li><a class="tocitem" href="physical_systems/Petviashvilli.html">Petviashvilli</a></li><li><a class="tocitem" href="physical_systems/Smoluchowski.html">Smoluchowski</a></li><li><a class="tocitem" href="physical_systems/Stratified.html">Stratified</a></li><li><a class="tocitem" href="physical_systems/generalities.html">Generalities</a></li><li><a class="tocitem" href="physical_systems/TestTimeStepping.html">TestTimeStepping</a></li></ul></li><li><a class="tocitem" href="numerical-methods.html">Numerical methods</a></li><li><a class="tocitem" href="multithreading.html">Multithreading</a></li><li><a class="tocitem" href="plots.html">Plots</a></li><li><a class="tocitem" href="creating-new-solvers.html">Creating new solvers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="basics.html">Basics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="basics.html">Basics</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basics"><a class="docs-heading-anchor" href="#Basics">Basics</a><a id="Basics-1"></a><a class="docs-heading-anchor-permalink" href="#Basics" title="Permalink"></a></h1><p>We use structures for storing grids, dissipation coefficients, parameters, diagnostics, etc. For all physical systems, we define a general structure containing all variables and parameters necessary for a simulation (see e.g. <a href="physical_systems/Acoustic.html#WavKinS.Acoustic2D"><code>Acoustic2D</code></a>).</p><h2 id="Structures"><a class="docs-heading-anchor" href="#Structures">Structures</a><a id="Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Structures" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.diagnostic_container" href="#WavKinS.diagnostic_container"><code>WavKinS.diagnostic_container</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Structure containing diagnostics, spectra, etc.</p><pre><code class="nohighlight hljs">glob_diag::Dict{String, global_ouput} # dictionary with global outputs
sp_outs::Dict{String, spectral_output} # dictionary with spectral outputs
sp_store::Dict{String, Array{Float64}} # dictionary with stored in memory spectral quantities</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.diagnostic_container-Tuple{Int64, Int64}" href="#WavKinS.diagnostic_container-Tuple{Int64, Int64}"><code>WavKinS.diagnostic_container</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function diagnostic_container(Mh::Int, Mz::Int)</code></pre><p>Constructor of a <a href="basics.html#WavKinS.diagnostic_container"><code>diagnostic_container</code></a> for <a href="basics.html#WavKinS.wave_spectrum_khkz"><code>wave_spectrum_khkz</code></a> with <code>Mh</code> and <code>Mz</code> points.  Same ininitialisation as <a href="basics.html#WavKinS.diagnostic_container-Tuple{Int64}"><code>diagnostic_container(M::Int)</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.diagnostic_container-Tuple{Int64}" href="#WavKinS.diagnostic_container-Tuple{Int64}"><code>WavKinS.diagnostic_container</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function diagnostic_container(M::Int)</code></pre><p>Constructor of a <a href="basics.html#WavKinS.diagnostic_container"><code>diagnostic_container</code></a> for a <a href="basics.html#WavKinS.wave_spectrum"><code>wave_spectrum</code></a> with <code>M</code> points.</p><pre><code class="nohighlight hljs">The dictionaries are initialised by default with standard outputs:
glob_diag : It contains the keys &quot;Times&quot;, &quot;H&quot;, &quot;N&quot;, and &quot;Disp&quot;:
    &quot;Times&quot; =&gt; &quot;Times of global quantities&quot;
    &quot;H&quot; =&gt; &quot;Total energy&quot;  
    &quot;N&quot; =&gt; &quot;Total wave action&quot;  
    &quot;Disp&quot; =&gt; &quot;&quot;Total dissipation&quot;&quot;    

sp_outs : It contains the keys &quot;nk&quot;, &quot;Ek&quot;, and &quot;Pk&quot;
    &quot;nk&quot; =&gt; &quot;Wave action spectrum&quot;
    &quot;Ek&quot; =&gt; &quot;Energy spectrum&quot;
    &quot;Pk&quot; =&gt; &quot;Energy flux&quot;

sp_store : It contains the keys &quot;nk&quot;, &quot;Pk&quot;, and &quot;Tsp&quot;
    &quot;nk&quot; =&gt; &quot;Wave action spectrum&quot;
    &quot;Pk&quot; =&gt; &quot;Energy spectrum&quot;
    &quot;Tsp&quot; =&gt; &quot;Times of stored spectra&quot;</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.field_grid_1D" href="#WavKinS.field_grid_1D"><code>WavKinS.field_grid_1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Basic structure for a 1D field defined on an arbitrary grid. </p><pre><code class="nohighlight hljs">M::Int: number of grid points
kk::Vector{Float64}: grid
F::Vector{Float64}: field</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.field_grid_1D-Tuple{Vector{Float64}}" href="#WavKinS.field_grid_1D-Tuple{Vector{Float64}}"><code>WavKinS.field_grid_1D</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">field_grid_1D(kk::Vector{Float64})</code></pre><p>Constructor of the <a href="basics.html#WavKinS.field_grid_1D"><code>field_grid_1D</code></a> structure. </p><ul><li><code>kk</code>: grid</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.force_dissipation" href="#WavKinS.force_dissipation"><code>WavKinS.force_dissipation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Structure for storing forcing and dissipation coefficients <span>$f_{\bf k}$</span> and <span>$d_{\bf k}$</span>.</p><pre><code class="nohighlight hljs">f::VecOrMat{Float64} # forcing of the WKE
D::VecOrMat{Float64} # dissipation of the WKE</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.force_dissipation-Tuple{Int64, Int64}" href="#WavKinS.force_dissipation-Tuple{Int64, Int64}"><code>WavKinS.force_dissipation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">force_dissipation(Mh::Int, Mz::Int)</code></pre><p>Constructor of <a href="basics.html#WavKinS.force_dissipation"><code>force_dissipation</code></a> for axisymmetric or 2D systems.</p><ul><li><code>Mh</code>: number of horizontal wave vector grid points </li><li><code>Mz</code>: number of vertical wave vector grid points</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.force_dissipation-Tuple{Int64}" href="#WavKinS.force_dissipation-Tuple{Int64}"><code>WavKinS.force_dissipation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">force_dissipation(M::Int)</code></pre><p>Constructor of <a href="basics.html#WavKinS.force_dissipation"><code>force_dissipation</code></a> for isotropic or 1D systems.</p><ul><li><code>M</code>: number of wave vector grid points </li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.global_ouput" href="#WavKinS.global_ouput"><code>WavKinS.global_ouput</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Basic structure for storing a global variable. </p><pre><code class="nohighlight hljs">longname::string  # long name
out::Vector{Float64} # vector containing the output</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.global_ouput-Tuple{Any}" href="#WavKinS.global_ouput-Tuple{Any}"><code>WavKinS.global_ouput</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">global_ouput(longname)</code></pre><p>Constructor of a <a href="basics.html#WavKinS.global_ouput"><code>global_output</code></a>. </p><ul><li><code>longname</code>: long name of the global variable</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.kinematic_box" href="#WavKinS.kinematic_box"><code>WavKinS.kinematic_box</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Basic structure for a kinematic box with <span>$p$</span> and <span>$q$</span> variables.  <img src="assets/kinematic_box.png" alt/> We use <span>$a$</span> such that <span>$p=a-k_h ∈ [-k_h:0]$</span> or <span>$p=k_h-a ∈ [0:k_h]$</span>.  Note: The horizontal wave vectors of first and second waves are <span>$k_{1h} = (k_h + p + q)/2$</span> and <span>$k_{2h} = (k_h - p + q)/2$</span>.</p><pre><code class="nohighlight hljs">Ma::Vector{Int} # number of points in a (depends on kh)
Mq::Int # number of points in q 
λa::Vector{Float64} # logarithmic increment of the meshes in a (depends on kh)
λq::Float64 # logarithmic increment of the mesh in q
logλa::Vector{Float64} # log(λa)
logλq::Float64 # log(λq)
aa::Vector{Vector{Float64}} # meshes of a (depends on kh)
qq::Vector{Float64} # mesh of q</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.kinematic_box-Tuple{Vector{Float64}, Vector{Float64}, Vector{Int64}, Float64, Float64, Int64}" href="#WavKinS.kinematic_box-Tuple{Vector{Float64}, Vector{Float64}, Vector{Int64}, Float64, Float64, Int64}"><code>WavKinS.kinematic_box</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kinematic_box(amin::Vector{Float64}, amax::Vector{Float64}, Ma::Vector{Int}, qmin::Float64, qmax::Float64, Mq::Int)</code></pre><p>Constructor of a <a href="basics.html#WavKinS.kinematic_box"><code>kinematic_box</code></a> structure. </p><ul><li><code>amin</code>: minimal value of <span>$a$</span> (depends on <span>$k_h$</span>)</li><li><code>amax</code>: maximal value of <span>$a$</span> (depends on <span>$k_h$</span>)</li><li><code>Ma</code>: number of grid points in a (depends on <span>$k_h$</span>)</li><li><code>qmin</code>: minimal value of <span>$q$</span></li><li><code>qmax</code>: maximal value of <span>$q$</span></li><li><code>Mq</code>: number of grid points in <span>$q$</span></li></ul><p>The <span>$a$</span> grid points are <span>$a[i] = a_{\rm min} λ_a^{i-1}$</span> where <span>$λ_a$</span> is the logarithmic increment such that <span>$a[M_a] = a_{\rm max}$</span>. The <span>$q$</span> grid points are <span>$q[i] = q_{\rm min} λ_q^{i-1}$</span> where <span>$λ_q$</span> is the logarithmic increment such that <span>$q[M_q] = q_{\rm max}$</span>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.spectral_output" href="#WavKinS.spectral_output"><code>WavKinS.spectral_output</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Basic structure for storing a spectrum. </p><pre><code class="nohighlight hljs">longname::String  # long name of the variable
sp::VecOrMat{Float64}  # spectrum
write_sp::Bool # write and compute this spectrum</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.spectral_output-Tuple{String, Int64, Int64}" href="#WavKinS.spectral_output-Tuple{String, Int64, Int64}"><code>WavKinS.spectral_output</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> spectral_output(longname,Mh, Mz)</code></pre><p>Constructor of a <a href="basics.html#WavKinS.spectral_output"><code>spectral_output</code></a> for axisymmetric or 2D systems.</p><ul><li><code>longname</code>: long name of the spectrum</li><li><code>Mh</code>: number of horizontal wave vector grid points </li><li><code>Mz</code>: number of vertical wave vector grid points</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.spectral_output-Tuple{String, Int64}" href="#WavKinS.spectral_output-Tuple{String, Int64}"><code>WavKinS.spectral_output</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> spectral_output(longname,M)</code></pre><p>Constructor of a <a href="basics.html#WavKinS.spectral_output"><code>spectral_output</code></a> for isotropic or 1D systems.</p><ul><li><code>longname</code>: long name of the spectrum</li><li><code>M</code>: number of wave vector grid points </li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.wave_spectrum" href="#WavKinS.wave_spectrum"><code>WavKinS.wave_spectrum</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Basic structure for an isotropic or 1D field with logarithmic grid. </p><pre><code class="nohighlight hljs">M::Int # number of points
nk::Vector{Float64} # wave action
λ::Float64 # logarithmic increment of the mesh
logλ::Float64 # log(λ)
kk::Vector{Float64} # wave vector</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.wave_spectrum-Tuple{Float64, Float64, Int64}" href="#WavKinS.wave_spectrum-Tuple{Float64, Float64, Int64}"><code>WavKinS.wave_spectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wave_spectrum(kmin::Float64, kmax::Float64, M::Int)</code></pre><p>Constructor of a <a href="basics.html#WavKinS.wave_spectrum"><code>wave_spectrum</code></a> structure. </p><ul><li><code>kmin</code>: minimal wave vector </li><li><code>kmax</code>: maximal wave vector</li><li><code>M</code>: number of grid points</li></ul><p>The wave vector grid points are <span>$k[i] = k_{\rm min} λ^{i-1}$</span> where <span>$λ$</span> is the logarithmic increment such that <span>$k[M] = k_{\rm max}$</span>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.wave_spectrum_khkz" href="#WavKinS.wave_spectrum_khkz"><code>WavKinS.wave_spectrum_khkz</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Basic structure for an axisymmetric or 2D (with <span>$k_z ↔ -k_z$</span> symmetry) spectrum. </p><pre><code class="nohighlight hljs">Mh::Int # number of points in the horizontal
Mz::Int # number of points in the vertical 
nk::Array{Float64,2} # wave action
λh::Float64 # logarithmic increment of the mesh in the horizontal
λz::Float64 # logarithmic increment of the mesh in the vertical
logλh::Float64 # log(λh)
logλz::Float64 # log(λz)
kkh::Vector{Float64} # horizontal wave vector modulus
kkz::Vector{Float64} # vertical wave vector modulus
kk::Array{Float64,2} # wave vector modulus</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.wave_spectrum_khkz-Tuple{Float64, Float64, Int64, Float64, Float64, Int64}" href="#WavKinS.wave_spectrum_khkz-Tuple{Float64, Float64, Int64, Float64, Float64, Int64}"><code>WavKinS.wave_spectrum_khkz</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wave_spectrum_khkz(khmin::Float64, khmax::Float64, Mh::Int, kzmin::Float64, kzmax::Float64, Mz::Int)</code></pre><p>Constructor of a <a href="basics.html#WavKinS.wave_spectrum_khkz"><code>wave_spectrum_khkz</code></a> structure. </p><ul><li><code>khmin</code>: minimal horizontal wave vector </li><li><code>khmax</code>: maximal horizontal wave vector</li><li><code>Mh</code>: number of horizontal wave vector grid points</li><li><code>kzmin</code>: minimal vertical wave vector </li><li><code>kzmax</code>: maximal vertical wave vector</li><li><code>Mz</code>: number of vertical wave vector grid points</li></ul><p>The horizontal wave vector grid points are <span>$k_h[i_h] = k_{h {\rm min}} λ_h^{i_h-1}$</span> where <span>$λ_h$</span> is the logarithmic increment such that <span>$k_h[M_h] = k_{h {\rm max}}$</span>. The vertical wave vector grid points are <span>$k_z[i_z] = k_{z {\rm min}} λ_z^{i_z-1}$</span> where <span>$λ_z$</span> is the logarithmic increment such that <span>$k_z[M_z] = k_{z {\rm max}}$</span>.</p></div></section></article><h2 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.simulation_parameters" href="#WavKinS.simulation_parameters"><code>WavKinS.simulation_parameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Basic structure containing information about the simulation.</p><pre><code class="nohighlight hljs">dt::Float64 # time step of the simulation
tplot::Float64 # Plot every tplot times
tglobal::Float64 # Compute, store and write global quantities every tglobal times 
tspstore::Float64 # Compute and store spectral quantities every tspstore times
tspwrite::Float64 # write spectra every tspwrite

outputDir::String #output directory
write_global::Bool #write global
write_spectral::Bool #write spectra</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.simulation_parameters-NTuple{4, Any}" href="#WavKinS.simulation_parameters-NTuple{4, Any}"><code>WavKinS.simulation_parameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulation_parameters(dt,tplot,tglobal,tspstore)</code></pre><p>Constructor for <a href="basics.html#WavKinS.simulation_parameters"><code>simulation_parameters</code></a> structure.</p><ul><li><code>dt</code>: time step of the simulation</li><li><code>tplot</code>: plot every tplot times</li><li><code>tglobal</code>: compute, store and write global quantities every tglobal times </li><li><code>tspstore</code>: compute and store spectral quantities every tspstore times</li></ul></div></section></article><h2 id="Diagnostics"><a class="docs-heading-anchor" href="#Diagnostics">Diagnostics</a><a id="Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.compute_spectral!-Tuple{Any}" href="#WavKinS.compute_spectral!-Tuple{Any}"><code>WavKinS.compute_spectral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_spectral!(Run)</code></pre><p>Compute and store default current spectral quantities</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li></ul><p>This routine computes and store in <code>Run.diags.sp_outs</code> the default spectral quantities: the waveaction, energy, and the energy fluc spectra. This routine is typically called from <code>compute_spectral!(Run)</code> which might add additional spectra for each physical system.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.density_dissipation" href="#WavKinS.density_dissipation"><code>WavKinS.density_dissipation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">density_dissipation(Run, ρ=one)</code></pre><p>Compute total dissipation weighted by the density  <span>$\rho$</span> as  <span>$\int d_{\bf k} \rho_{\bf k} n_{\bf k} \mathrm{d}{\bf k}$</span>.</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span>and the dissipation coefficients <span>$d_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.density_flux!" href="#WavKinS.density_flux!"><code>WavKinS.density_flux!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> density_flux!(Pk::AbstractVector, Run,ρ=one)</code></pre><p>Compute flux of a density <span>$\rho$</span>. For isotropic systems, it is <span>$P(k) = - \int\limits_{|{\bf k}&#39;|&lt;k} \rho_{{\bf k}&#39;} St_{{\bf k}&#39;} \mathrm{d}{{\bf k}&#39;}$</span>.</p><ul><li><code>Pk</code>: AbstractVector where flux is stored</li><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.density_flux_angular!" href="#WavKinS.density_flux_angular!"><code>WavKinS.density_flux_angular!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">density_flux_angular!(thk::AbstractVector, Pthk::AbstractVector, Run, ρ=one)</code></pre><p>Compute angular flux of a density <span>$\rho$</span>. It is <span>$P(\theta_{\bf k}) = - \int\limits_{\theta_{{\bf k}&#39;}&lt;\theta_{{\bf k}}} \rho_{{\bf k}&#39;} St_{{\bf k}&#39;} \mathrm{d}{{\bf k}&#39;}$</span>.</p><ul><li><code>thk</code>: AbstractVector for the angles grid</li><li><code>Pthk</code>: AbstractVector where flux is stored</li><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.density_flux_isotropic!" href="#WavKinS.density_flux_isotropic!"><code>WavKinS.density_flux_isotropic!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">density_flux_isotropic!(Pk::AbstractVector, Run,ρ=one)</code></pre><p>Compute isotric (after sum over angle) flux of a density <span>$\rho$</span>. It is <span>$P(k) = - \int\limits_{|{\bf k}&#39;|&lt;k} \rho_{{\bf k}&#39;} St_{{\bf k}&#39;} \mathrm{d}{{\bf k}&#39;}$</span>.</p><ul><li><code>Pk</code>: AbstractVector where flux is stored</li><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.density_injection" href="#WavKinS.density_injection"><code>WavKinS.density_injection</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">density_injection(Run, ρ=one)</code></pre><p>Compute total injection weighted by the density  <span>$\rho$</span> as  <span>$\int \rho_{\bf k} f_{\bf k} \mathrm{d}{\bf k}$</span>.    </p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span> and the forcing coefficients <span>$f_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.density_spectrum!" href="#WavKinS.density_spectrum!"><code>WavKinS.density_spectrum!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">density_spectrum!(Ek::Union{AbstractVector,AbstractMatrix}, Run, ρ=one)</code></pre><p>Compute spectrum of a quantity with spectral density <span>$\rho$</span>. For isotropic systems, it is <span>$s(k) = \rho_{\bf k} n_{\bf k} k^{d-1} \mathrm{d}\Omega$</span>. For axisymmetric systems, it is <span>$s(k_h,k_z) = \rho_{\bf k} n_{\bf k} k_h^{d-1} \mathrm{d}\Omega$</span>.</p><ul><li><code>Ek</code>: where spectrum is stored</li><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span>, physical dimension <span>$d$</span> and surface of the unit sphere (or of the isotropic sector) <span>$\mathrm{d}Ω$</span></li><li><code>ρ</code>: density. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.energy-Tuple{Any}" href="#WavKinS.energy-Tuple{Any}"><code>WavKinS.energy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy(Run)</code></pre><p>Compute total energy <span>$\int \omega_{\bf k} n_{\bf k} \mathrm{d}{\bf k}$</span>. </p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span> and the dispersion relation <span>$\omega_{\bf k}$</span></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.energy_conservation_ratio-Tuple{Any}" href="#WavKinS.energy_conservation_ratio-Tuple{Any}"><code>WavKinS.energy_conservation_ratio</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_conservation_ratio(Run)</code></pre><p>Compute the ratio <span>$\frac{\left| \int \omega_{\bf k} St_{\bf k} \mathrm{d}{\bf k} \right|}{\int \omega_{\bf k} |St_{\bf k}| \mathrm{d}{\bf k}}$</span>.</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span>, the dispersion relation <span>$\omega_{\bf k}$</span> and the collision integral <span>$St_{\bf k}$</span></li></ul><p>Note: If the energy is a dynamical invariant, this ratio must tends to zero as the resolution increases (see <a href="https://journals.ametsoc.org/view/journals/phoc/49/3/jpo-d-18-0075.1.xml">Eden <em>et al.</em>, J. Phys. Oceanogr. 49, 737-749 (2019)</a>).</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.energy_dissipation-Tuple{Any}" href="#WavKinS.energy_dissipation-Tuple{Any}"><code>WavKinS.energy_dissipation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_dissipation(Run)</code></pre><p>Compute total energy dissipation of the system <span>$\int d_{\bf k} \omega_{\bf k} n_{\bf k} \mathrm{d}{\bf k}$</span>.</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span>, the dispersion relation <span>$\omega_{\bf k}$</span> and the dissipation coefficients <span>$d_{\bf k}$</span></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.energy_flux!-Tuple{AbstractVector, Any}" href="#WavKinS.energy_flux!-Tuple{AbstractVector, Any}"><code>WavKinS.energy_flux!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_flux!(Pk::AbstractVector, Run)</code></pre><p>Compute energy flux. For isotropic systems, it is <span>$P(k) = - \int\limits_{|{\bf k}&#39;|&lt;k} \omega_{{\bf k}&#39;} St_{{\bf k}&#39;} \mathrm{d}{{\bf k}&#39;}$</span>.</p><ul><li><code>Pk</code>: where energy flux is stored</li><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span> and dispersion relation <span>$\omega_{\rm k}$</span></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.energy_injection-Tuple{Any}" href="#WavKinS.energy_injection-Tuple{Any}"><code>WavKinS.energy_injection</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_injection(Run)</code></pre><p>Compute total energy injection of the system <span>$\int \omega_{\bf k} f_{\bf k} \mathrm{d}{\bf k}$</span>.</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span>, the dispersion relation <span>$\omega_{\bf k}$</span> and the forcing coefficients <span>$f_{\bf k}$</span></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.energy_spectrum!-Tuple{Union{AbstractMatrix, AbstractVector}, Any}" href="#WavKinS.energy_spectrum!-Tuple{Union{AbstractMatrix, AbstractVector}, Any}"><code>WavKinS.energy_spectrum!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_spectrum!(Ek::Union{AbstractVector,AbstractMatrix},Run,ρ=one)</code></pre><p>Compute energy spectrum. </p><ul><li><code>Ek</code>: where energy spectrum is stored</li><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.get_global_diagnostics!-Tuple{Any}" href="#WavKinS.get_global_diagnostics!-Tuple{Any}"><code>WavKinS.get_global_diagnostics!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_global_diagnostics(Run)</code></pre><p>Compute default global diagnostics</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li></ul><p>This routine computes and store in <code>Run.diags.glob_diag</code> the default diagnostics: The current time, the total waveaction, the total energy, and the total dissipation.</p><p>This routine is typically called from <code>get_global_diagnostics(Run)</code> which might add additional diagnostics for each physical system.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.isotropic_density_spectrum!" href="#WavKinS.isotropic_density_spectrum!"><code>WavKinS.isotropic_density_spectrum!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isotropic_density_spectrum!(Run, ρ=one)</code></pre><p>Compute isotropic spectrum of a quantity with spectral density <span>$\rho$</span> as <span>$s(k) = \frac{1}{\mathrm{d}k} \int\limits_{|{\bf k&#39;}|=k}^{k+\mathrm{d}k} \rho_{\bf k} n_{\bf k} \mathrm{d}{{\bf k}&#39;}$</span>. </p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.kh_density_spectrum!" href="#WavKinS.kh_density_spectrum!"><code>WavKinS.kh_density_spectrum!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kh_density_spectrum!(Run, ρ=one)</code></pre><p>For axisymmetric systems, compute <span>$k_h$</span> spectrum (after average over <span>$k_z$</span>) of a quantity with spectral density <span>$\rho$</span>. </p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.kz_density_spectrum!" href="#WavKinS.kz_density_spectrum!"><code>WavKinS.kz_density_spectrum!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kz_density_spectrum!(Run, ρ=one)</code></pre><p>For axisymmetric systems, compute <span>$k_z$</span> spectrum (after average over <span>$k_h$</span>) of a quantity with spectral density <span>$\rho$</span>. </p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.store_spectral!-Tuple{Any}" href="#WavKinS.store_spectral!-Tuple{Any}"><code>WavKinS.store_spectral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">store_spectral!(Run)</code></pre><p>Compute and store default spectral quantities</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li></ul><p>This routine computes and store in <code>Run.diags.sp_store</code> the default spectral quantities: the waveaction and the energy fluc spectrum. This routine is typically called from <code>store_spectral(Run)</code> which might add additional spectra for each physical system.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.total_density_abs_flux" href="#WavKinS.total_density_abs_flux"><code>WavKinS.total_density_abs_flux</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">total_density_abs_flux(Run,ρ)</code></pre><p>Compute sum of the absolute value of the flux weighted by the density <span>$\rho$</span> as <span>$\int \rho_{\bf k} |St_{\bf k}| \mathrm{d}{\bf k}$</span>.</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span> and the collision integral <span>$St_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.total_density_flux" href="#WavKinS.total_density_flux"><code>WavKinS.total_density_flux</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">total_density_flux(Run,ρ)</code></pre><p>Compute sum of the flux weighted by the density <span>$\rho$</span> as <span>$\int \rho_{\bf k} St_{\bf k} \mathrm{d}{\bf k}$</span>.    </p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span> and the collision integral <span>$St_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul><p>Note: Ideally, it should be zero for a dynamical invariant (e.g. energy should be conserved for Acoustic, Petviashvilli, Strat_Asymp, ...).</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.total_entropy-Tuple{Any}" href="#WavKinS.total_entropy-Tuple{Any}"><code>WavKinS.total_entropy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">total_entropy(Run)</code></pre><p>Compute total wave action entropy <span>$\int \log(n_{\bf k}) \mathrm{d}{\bf k}$</span>.</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.total_integral_density" href="#WavKinS.total_integral_density"><code>WavKinS.total_integral_density</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">total_integral_density(Run,ρ)</code></pre><p>Compute total integral weighted by the density <span>$\rho$</span> as <span>$\int \rho_{\bf k} n_{\bf k} \mathrm{d}{\bf k}$</span>.</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li><li><code>ρ</code>: a function defining the weight of the integral. By default ρ()=1</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.total_waveaction-Tuple{Any}" href="#WavKinS.total_waveaction-Tuple{Any}"><code>WavKinS.total_waveaction</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">total_waveaction(Run)</code></pre><p>Compute total wave action <span>$\int n_{\bf k} \mathrm{d}{\bf k}$</span>. </p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.waveaction_dissipation-Tuple{Any}" href="#WavKinS.waveaction_dissipation-Tuple{Any}"><code>WavKinS.waveaction_dissipation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">waveaction_dissipation(Run)</code></pre><p>Compute total wave action dissipation of the system <span>$\int d_{\bf k} n_{\bf k} \mathrm{d}{\bf k}$</span>.</p><ul><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span> and the dissipation coefficients <span>$d_{\bf k}$</span></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.waveaction_flux!-Tuple{AbstractVector, Any}" href="#WavKinS.waveaction_flux!-Tuple{AbstractVector, Any}"><code>WavKinS.waveaction_flux!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">waveaction_flux!(Qk::AbstractVector, Run)</code></pre><p>Compute waveaction flux. For isotropic systems, it is <span>$P(k) = - \int\limits_{|{\bf k}&#39;|&lt;k} St_{{\bf k}&#39;} \mathrm{d}{{\bf k}&#39;}$</span>.</p><ul><li><code>Qk</code>: where energy flux is stored</li><li><code>Run</code>: WavKinS simulation structure containing the wave action <span>$n_{\bf k}$</span></li></ul></div></section></article><h2 id="Outputs"><a class="docs-heading-anchor" href="#Outputs">Outputs</a><a id="Outputs-1"></a><a class="docs-heading-anchor-permalink" href="#Outputs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.init_IO-Tuple{Any, String}" href="#WavKinS.init_IO-Tuple{Any, String}"><code>WavKinS.init_IO</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_IO(Run, outputDir::String)</code></pre><p>Inputs/Outputs initialization.</p><ul><li><code>Run</code>: WavKinS simulation structure</li><li><code>outputDir</code>: path of the output directory </li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.load_spectral_for_change_mesh!-Tuple{wave_spectrum, String, Any}" href="#WavKinS.load_spectral_for_change_mesh!-Tuple{wave_spectrum, String, Any}"><code>WavKinS.load_spectral_for_change_mesh!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_spectral_for_change_mesh!(Nk::wave_spectrum, datafile::String, Run; irestart=-1)</code></pre><p>Load wave action spectrum to change the mesh.</p><ul><li><code>Run</code>: WavKinS simulation structure</li><li><code>datafile</code>: path of the output file  </li><li><code>irestart</code>: time step</li></ul><p>By default, it loads the spectrum at the latest time step.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.load_spectrum-Tuple{Any, String}" href="#WavKinS.load_spectrum-Tuple{Any, String}"><code>WavKinS.load_spectrum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_spectrum(Run, outputDir::String; irestart=-1)</code></pre><p>Load wave action spectrum.</p><ul><li><code>Run</code>: WavKinS simulation structure</li><li><code>outputDir</code>: path of the output directory   </li><li><code>irestart</code>: time step</li></ul><p>By default, it loads the spectrum at the latest time step.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.output_global-Tuple{Any, String}" href="#WavKinS.output_global-Tuple{Any, String}"><code>WavKinS.output_global</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">output_global(Run, outputDir::String)</code></pre><p>Write global output (total wave action, total energy, ...).</p><ul><li><code>Run</code>: WavKinS simulation structure</li><li><code>outputDir</code>: path of the output directory  </li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.output_spectra-Tuple{Any, String}" href="#WavKinS.output_spectra-Tuple{Any, String}"><code>WavKinS.output_spectra</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">output_spectra(Run, outputDir::String)</code></pre><p>Write spectra.</p><ul><li><code>Run</code>: WavKinS simulation structure</li><li><code>outputDir</code>: path of the output directory   </li></ul></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="quick_start/diagnostics_tutorial.html">« Adding a diagnostic</a><a class="docs-footer-nextpage" href="physical_systems/Acoustic.html">Acoustic »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 27 November 2024 11:14">Wednesday 27 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
