<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Petviashvilli · WavKinS.jl</title><meta name="title" content="Petviashvilli · WavKinS.jl"/><meta property="og:title" content="Petviashvilli · WavKinS.jl"/><meta property="twitter:title" content="Petviashvilli · WavKinS.jl"/><meta name="description" content="Documentation for WavKinS.jl."/><meta property="og:description" content="Documentation for WavKinS.jl."/><meta property="twitter:description" content="Documentation for WavKinS.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="WavKinS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">WavKinS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Quick start</span><ul><li><a class="tocitem" href="../quick_start/installation.html">Installing WavKinS</a></li><li><a class="tocitem" href="../quick_start/collisional_integral_tutorial.html">Computing a collisional integral</a></li><li><a class="tocitem" href="../quick_start/running_tutorial.html">Running an example</a></li><li><a class="tocitem" href="../quick_start/diagnostics_tutorial.html">Adding a diagnostic</a></li></ul></li><li><a class="tocitem" href="../basics.html">Basics</a></li><li><span class="tocitem">Physical systems</span><ul><li><a class="tocitem" href="Acoustic.html">Acoustic</a></li><li><a class="tocitem" href="Bogoliubov.html">Bogoliubov</a></li><li><a class="tocitem" href="NLS.html">NLS</a></li><li><a class="tocitem" href="MMT.html">MMT</a></li><li class="is-active"><a class="tocitem" href="Petviashvilli.html">Petviashvilli</a><ul class="internal"><li><a class="tocitem" href="#Petviashvilli_Asympsolver"><span>Petviashvilli_Asympsolver</span></a></li></ul></li><li><a class="tocitem" href="Smoluchowski.html">Smoluchowski</a></li><li><a class="tocitem" href="Stratified.html">Stratified</a></li><li><a class="tocitem" href="generalities.html">Generalities</a></li><li><a class="tocitem" href="TestTimeStepping.html">TestTimeStepping</a></li></ul></li><li><a class="tocitem" href="../numerical-methods.html">Numerical methods</a></li><li><a class="tocitem" href="../multithreading.html">Multithreading</a></li><li><a class="tocitem" href="../plots.html">Plots</a></li><li><a class="tocitem" href="../creating-new-solvers.html">Creating new solvers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Physical systems</a></li><li class="is-active"><a href="Petviashvilli.html">Petviashvilli</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="Petviashvilli.html">Petviashvilli</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Petviashvilli_Asympsolver"><a class="docs-heading-anchor" href="#Petviashvilli_Asympsolver">Petviashvilli_Asympsolver</a><a id="Petviashvilli_Asympsolver-1"></a><a class="docs-heading-anchor-permalink" href="#Petviashvilli_Asympsolver" title="Permalink"></a></h2><p>The Petviashvilli equation is an important model describing geophysical flows and fusion plasmas. In particular, it models drift waves in plasmas and Rossby waves in geophysical fluids. For a theoretical application of the WWT to this model, see <a href="https://link.springer.com/book/10.1007/978-3-642-15942-8">Nazarenko, Springer, Volume 825 of Lecture Notes in Physics (2011)</a>, where the Petviashvilli equation is used as a master example to introduce the theory.</p><h3 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h3><p>In the solver, we consider the asymptotic Petviashvilli WKE <span>$\dot{n}_{\bf k}=St_{\bf k}$</span> that explicitly reads</p><p class="math-container">\[St_{\bf k}=\int (\mathcal{R}^{\bf k}_{12}-\mathcal{R}^{1}_{2 {\bf k}}-\mathcal{R}^{2}_{{\bf k}1})\mathrm{d}{\bf k}_1\mathrm{d}{\bf k}_2\]</p><p>with <span>$\mathcal{R}^{\bf k}_{12}=2\pi|V_{{\bf k}12}|^2(n_1n_2-n_1n_{\bf k}-n_{\bf k}n_2)\delta({{\bf k}-{\bf k}_1-{\bf k}_2})\delta(\omega_{\bf k}- \omega_1- \omega_2)$</span> and <span>${\bf k}=(k_x,k_y)$</span>, with <span>$k_x&gt;0$</span>. In particular, we consider the asymptotic limit <span>$k_x\ll k_y$</span>, for which the interaction coefficient and dispersion relation are</p><p class="math-container">\[\omega_{\bf k}= k_x k_y^2,\quad V_{{\bf 123}}=\frac{1}{2}\sqrt{k_{1x}k_{2x}k_{3x}}\]</p><p>This wave kinetic equation conserves the total energy <span>$H$</span>, the potential vorticity <span>$\Omega$</span> and the zonostrophy <span>$\Phi$</span></p><p class="math-container">\[H = \int_{k_x&gt;0} \omega_{\bf k} n_{\bf k} d{\bf k},\quad \Omega = \int_{k_x&gt;0} k_x n_{\bf k} d{\bf k},\quad \Phi= \int_{k_x&gt;0} \frac{k_x^3}{k_y^2} n_{\bf k} d{\bf k},\quad\]</p><h3 id="Solver"><a class="docs-heading-anchor" href="#Solver">Solver</a><a id="Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Solver" title="Permalink"></a></h3><h4 id="The-reduced-asymptotic-Petviashvilli-WKE-wave-kinetic-equation"><a class="docs-heading-anchor" href="#The-reduced-asymptotic-Petviashvilli-WKE-wave-kinetic-equation">The reduced asymptotic Petviashvilli WKE wave kinetic equation</a><a id="The-reduced-asymptotic-Petviashvilli-WKE-wave-kinetic-equation-1"></a><a class="docs-heading-anchor-permalink" href="#The-reduced-asymptotic-Petviashvilli-WKE-wave-kinetic-equation" title="Permalink"></a></h4><p>WavKinS solves the asymptotic Petviashvilli wave kinetic equation making use of the δ-Dirac&#39;s. More precisely, it solves the following kinetic equation</p><p class="math-container">\[\dot{n}_{\bf k}=St_{\bf k} =I_{\bf k}-2J_{\bf k}\]</p><p>where</p><p class="math-container">\[I_{\bf k}=\int_{-k_y}^0  \frac{\mathcal{R}^{\bf k}_{\bf 12}}{\Delta_{k_y k_{1y}}} dk_{1y} + \int_{k_y}^{2k_y}   \frac{\mathcal{R}^{\bf k}_{\bf 12}}{\Delta_{k_y k_{1y}}} dk_{1y}\]</p><p>with <span>${\bf k}_2={\bf k}-{\bf k}_1$</span>, and</p><p class="math-container">\[k_{1x}=k_x\frac{k_{1y}(2k_y-k_{1y})}{k_y(2k_{1y} - k_y)},\quad \Delta_{k_y k_{1y}} = |k_y(2k_{1y}-k_y)|\]</p><p>Similarly, the second term is </p><p class="math-container">\[J_{\bf k}=\int_{-\infty}^{-k_y}  \frac{\mathcal{R}^{\bf 1}_{\bf k2}}{\Delta_{k_y k_{1y}}} dk_{1y} + \int_{\frac{k_y}{2}}^{k_y}   \frac{\mathcal{R}^{\bf 1}_{\bf k2}}{\Delta_{k_y k_{1y}}} dk_{1y}\]</p><p>with <span>${\bf k}_2={\bf k}_1-{\bf k}$</span> and <span>$k_{1x}$</span> and <span>$\Delta_{k_y k_{1y}}$</span> as above. There are not strong divergences in the integrand.</p><p>In the integration, we assume <span>$n_{k_x,-k_y}=n_{k_x,k_y}$</span> and the integral is truncated at <span>$k_{{\rm max}\,y}$</span>. The truncated WKE, exactly conserves the truncated invariants. We use the logarithmic two-dimensional grid <a href="../basics.html#WavKinS.wave_spectrum_khkz"><code>wave_spectrum_khkz</code></a> to represent the waveaction spectrum <span>$n_{\bf k}$</span>. </p><p>Note the if we use <span>$M$</span> nodes to represent each coordinate of the Fourier space, then, the numerical cost of computing the collisional integral is of the order of <span>$M^3$</span> operations.</p><h4 id="Using-the-Petviashvilli_Asymp-solver"><a class="docs-heading-anchor" href="#Using-the-Petviashvilli_Asymp-solver">Using the Petviashvilli_Asymp solver</a><a id="Using-the-Petviashvilli_Asymp-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-Petviashvilli_Asymp-solver" title="Permalink"></a></h4><p>As all the other WavKinS solvers, we need to create a <a href="Petviashvilli.html#WavKinS.Petviashvilli_Asymp"><code>Petviashvilli_Asymp</code></a> structure containing all the fields, working space, diagnostics, etc.  </p><pre><code class="language-julia hljs">using WavKinS

# Create a waveaction structure containing the basic grid
Mx = 128 # set the number of nodes
My = 128 # set the number of nodes
kxmin = 1e-4 # minimal wave number
kxmax = 1.e-0 # maximal wave number
kymin = 1e-4 # minimal wave number
kymax = 1e-0 # maximal wave number

Nk = wave_spectrum_khkz(kxmin,kxmax,Mx,kymin,kymax,My);

# Creating a Petviashvilli_Asymp  structure with default parameters
Run = Petviashvilli_Asymp(Nk);</code></pre><p>The <code>Petviashvilli_Asymp</code> solver has implemented an option to compute the collisional term as a sink and a source term</p><p class="math-container">\[St_{\bf k} = -\gamma_{\bf k} n_{\bf k} + \eta_{\bf k}\]</p><p>The computation of <span>$γ$</span> and <span>$η$</span> are performed with the options <code>compute_γk</code> and <code>compute_ηk</code> and accessible as:    </p><pre><code class="language-julia hljs"># computing collisional integral
St_k!(Run;compute_Sk=true, compute_γk=true, compute_ηk=true)
γ_k = Run.γk
η_k = Run.ηk    </code></pre><p>If both, <code>compute_γk=false</code> and <code>compute_ηk=false</code>, then <span>$St_k$</span> is computed directly.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The Petviashvilli<em>Asymp solver is compatible with the time stepping `AB</em>Euler<em>step<code>and</code>AB2</em>RK2_step`, but still under testing. </p></div></div><h4 id="Diagnostics"><a class="docs-heading-anchor" href="#Diagnostics">Diagnostics</a><a id="Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics" title="Permalink"></a></h4><p>Spectral and global quantities can be directly computed using the provided routines (see  <a href="../quick_start/diagnostics_tutorial.html#Defining-a-new-diagnostic"><code>this tutorial</code></a>). In addition to the standard diagnostics, the solver computes the total potential enstrophy, zonostrophy, and their respective dissipation. They are stored in</p><pre><code class="language-julia hljs">    Run.diags.glob_diag[&quot;Mx&quot;].out # total potential enstrophy
    Run.diags.glob_diag[&quot;dMx&quot;].out # total potential enstrophy dissipation
    Run.diags.glob_diag[&quot;Phi&quot;].out # total zonostrophy
    Run.diags.glob_diag[&quot;dPhi&quot;].out # total zonostrophy dissipation</code></pre><h4 id="Testing-convergence-of-the-collisional-integral"><a class="docs-heading-anchor" href="#Testing-convergence-of-the-collisional-integral">Testing convergence of the collisional integral</a><a id="Testing-convergence-of-the-collisional-integral-1"></a><a class="docs-heading-anchor-permalink" href="#Testing-convergence-of-the-collisional-integral" title="Permalink"></a></h4><p>WavKinS provide a simple test of the numerical convergence of the computation of the collisional integral. The testing script is located in <code>/run/tests/physical_systems/tests_Petviashvilli_Asymp.jl</code>. </p><p>Theoretically, the collisional integral should conserve the energy, the potential enstrophy and the zonostrophy, which means that</p><p class="math-container">\[\int_{k_x&gt;0} \omega_{\bf k} St_{\bf k} d{\bf k}=0, \quad 
\int_{k_x&gt;0} kx St_{\bf k} d{\bf k}=0, 
\int_{k_x&gt;0} \frac{k_x^3}{k_y^2} St_{\bf k} d{\bf k}=0\]</p><p>The following numerical test evaluates those integrals and check the convergence to <span>$0$</span>.</p><pre><code class="language-julia hljs">using WavKinS

function nk_test(kx) #we define some test function
        return abs(ky)^3 * exp(-kx - abs(ky)) * kx^1.5 / (1.0 + abs(ky))
end

for M ∈ 2 .^ (4:6)
    Mx = M
    My = M
    kxmin = 5e-3
    kxmax = 5e+3
    kymin = 5e-3
    kymax = 5e+3

    Nk = wave_spectrum_khkz(kxmin, kxmax, Mx, kymin, kymax, My)
    Run = Petviashvilli_Asymp(Nk; interp_scheeme=WavKinS.bilin_interp_khkz)

    kx = Nk.kkh
    ky = Nk.kkz
    kk = Nk.kk
    KKX = kx .* ones(length(ky))&#39; # we get the two-dimensional mesh
    KKY = ones(length(kx)) .* ky&#39; # we get the two-dimensional mesh
    @. Nk.nk = nk_test.(KKX, KKY)

    WavKinS.St_k!(Run) # compute the collisional integral

    get_global_diagnostics!(Run)
    Ω = Run.diags.glob_diag[&quot;Mx&quot;].out[end] # Total potential enstrophy
    Φ= Run.diags.glob_diag[&quot;Phi&quot;].out[end] # Total zonostrophy
    Ene= Run.diags.glob_diag[&quot;H&quot;].out[end] # Total energy

    integ = WavKinS.integrate_with_log_bins_khkz()
    Flux = wave_spectrum_khkz(kxmin, kxmax, Mx, kymin, kymax, My) #a field to test the convergence 

    # Check conservation of energy
    @. Flux.nk = 2 * Run.Sk.nk * WavKinS.ω_Petviashvilli_Asymp(KKX, KKY)
    Sum_Flux_Ene = integrate(integ, Flux)

     # Check conservation of pontential entrophy
    @. Flux.nk = 2 * Run.Sk.nk * WavKinS.ρ_Potential_Petviashvilli_Asymp(KKX, KKY)
    Sum_Flux_Ω = integrate(integ, Flux)

     # Check conservation of zonostrophy
    @. Flux.nk = 2 * Run.Sk.nk * WavKinS.ρ_zonostrophy_Petviashvilli_Asymp(KKX, KKY)
    Sum_Flux_Φ = integrate(integ, Flux)

    println(&quot;Mx = &quot;, Mx, &quot;, My = &quot;, My, &quot;: sum fluxes E, Ω and Φ: &quot;, Sum_Flux_Ene / Ene, &quot; &quot;, Sum_Flux_Ω / Ω, &quot; &quot;, Sum_Flux_Φ / Φ)
end</code></pre><p>The output of this test is </p><pre><code class="nohighlight hljs">Mx = 16, My = 16: sum fluxes E, Ω and Φ: 1.710268715980057 1.8589880090916744 17.54853293874085
Mx = 32, My = 32: sum fluxes E, Ω and Φ: 0.2945159761052512 0.5493565471964945 7.612825119505001
Mx = 64, My = 64: sum fluxes E, Ω and Φ: 0.047152987403215815 0.09584411074860376 1.3042184389571956
Mx = 128, My = 128: sum fluxes E, Ω and Φ: 0.015444134461320853 0.024791030645795964 0.27800229384109115
Mx = 256, My = 256: sum fluxes E, Ω and Φ: 0.004373987907149068 0.007510845318850708 0.08816734805792001
Mx = 512, My = 512: sum fluxes E, Ω and Φ: 0.001182471464404374 0.002026386307332427 0.02317691111735061
Mx = 1024, My = 1024: sum fluxes E, Ω and Φ: 0.0003036763839915813 0.0004973832086118185 0.005512771277465468
Mx = 2048, My = 2048: sum fluxes E, Ω and Φ: 7.58630402627788e-5 0.00012665788264348718 0.0014091889296611471</code></pre><p>The solver conserves the invariant well and errors roughly decreases as <span>$M^{-2}$</span> as displayed in the next figure</p><p><img src="../assets/error_Petviashvilii.png" alt/></p><h4 id="Running-the-Petviashvilii-solver"><a class="docs-heading-anchor" href="#Running-the-Petviashvilii-solver">Running the Petviashvilii solver</a><a id="Running-the-Petviashvilii-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-Petviashvilii-solver" title="Permalink"></a></h4><p>WavKinS provides a ready to use script to obtain out-of-equilibrium steady states of the WKE. The script is similar to the one presented in the tutorial and can be found in <code>/run/simple/RunSimpleEvolution_Petviashvilli.jl</code>. Running the script will generate the following plot</p><p><img src="../assets/Petviashvilii_spectrum_full.png" alt/></p><p>The figure on the left is taken at a very early stage of the simulations where a localised forcing is clearly visible. At a later timed, energy cascades and fill the upper part of the spectral space.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>The previous simulation took less than 30 seconds on a 3 GHz 10-Core Intel Xeon W iMac Pro, using 16 cores. </p></div></div><h3 id="List-of-structures-and-methods-for-Petviashvilli-solvers"><a class="docs-heading-anchor" href="#List-of-structures-and-methods-for-Petviashvilli-solvers">List of structures and methods for Petviashvilli solvers</a><a id="List-of-structures-and-methods-for-Petviashvilli-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#List-of-structures-and-methods-for-Petviashvilli-solvers" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.Petviashvilli" href="#WavKinS.Petviashvilli"><code>WavKinS.Petviashvilli</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Petviashvilli</code></pre><p>Simulation structure for Petviashvilli wave turbulence It contains</p><pre><code class="nohighlight hljs">name::String #name of the simulation type
Nk_arguments::Int # Number of arguments of ``n_k``.  1: (fully symetric) , 2: (cylindrical average in 3D or mirror symmetric in 2D), 3: Only mirror symmetric in 3D
ω # Dispersion relation. This is a function of ``k``. It takes `Nk_argument` arguments

Nk::wave_spectrum_khkz #wave action
Sk::wave_spectrum_khkz #collisional integral
F1::wave_spectrum_khkz #working field
FSt::Vector{wave_spectrum} #Array of working fields for multithreading
partition::Vector{Tuple{UnitRange{Int64},UnitRange{Int64}}} #partition for multithreading

# Type of interpolation, integration, and time stepping scheemes
interp_scheeme::Interp_Scheeme
integ_scheeme::Integ_Scheeme
time_stepping::Time_Stepping

# Outputs and diagnostics
diags::diagnostic_container

t::Float64 #current time
dimension::Int # physical dimension of the system
dΩ::Float64 # surface of the unit sphere

FD::force_dissipation # Contains all the terms about force and dissipation.</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.Petviashvilli_Asymp" href="#WavKinS.Petviashvilli_Asymp"><code>WavKinS.Petviashvilli_Asymp</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Petviashvilli_Asymp</code></pre><p>Simulation structure for Petviashvilli for &#39;kx&lt;&lt;ky&#39; wave turbulence. It contains</p><pre><code class="nohighlight hljs">name::String #name of the simulation type
Nk_arguments::Int # Number of arguments of ``n_k``.  1: (fully symetric) , 2: (cylindrical average in 3D or mirror symmetric in 2D), 3: Only mirror symmetric in 3D
ω # Dispersion relation. This is a function of ``k``. It takes `Nk_argument` arguments

Nk::wave_spectrum_khkz #wave action
Sk::wave_spectrum_khkz #collisional integral
γk::Array{Float64,2} # gamma term of WKE
ηk::Array{Float64,2} # gamma term of WKE

F1::wave_spectrum_khkz #working field
FSt::Vector{wave_spectrum} #Array of working fields for multithreading
FSt1::Vector{wave_spectrum} #Array of working fields for multithreading
FSt2::Vector{wave_spectrum} #Array of working fields for multithreading
partition::Vector{Tuple{UnitRange{Int64},UnitRange{Int64}}} #partition for multithreading

# Type of interpolation, integration, and time stepping scheemes
interp_scheeme::Interp_Scheeme
integ_scheeme::Integ_Scheeme
time_stepping::Time_Stepping

# Outputs and diagnostics
diags::diagnostic_container

t::Float64 #current time
dimension::Int # physical dimension of the system
dΩ::Float64 # surface of the unit sphere

FD::force_dissipation # Contains all the terms about force and dissipation.</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.compute_spectral!-Tuple{Union{Petviashvilli, Petviashvilli_Asymp}}" href="#WavKinS.compute_spectral!-Tuple{Union{Petviashvilli, Petviashvilli_Asymp}}"><code>WavKinS.compute_spectral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_spectral(Run)</code></pre><p>Compute and store Petviashvilli_Asymp current spectral quantities</p><ul><li><code>Run</code>: Petviashvilli<em>Asymp or Petviashvilli WavKinS simulation structure containing the wave action ``n</em>{\bf k}``</li></ul><p>This routine computes and store in <code>Run.diags.sp_outs</code> the waveaction, energy spectra and their corresponding fluxes.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.get_global_diagnostics!-Tuple{Petviashvilli_Asymp}" href="#WavKinS.get_global_diagnostics!-Tuple{Petviashvilli_Asymp}"><code>WavKinS.get_global_diagnostics!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_global_diagnostics!(Run::Petviashvilli_Asymp)</code></pre><p>Compute default global diagnostics</p><ul><li><code>Run</code>: Petviashvilli<em>Asymp simulation structure containing the wave action ``n</em>{\bf k}``</li></ul><p>This routine computes and store in <code>Run.diags.glob_diag</code> the default diagnostics: The current time, the total waveaction, the total energy, total potential enstrophy, zonostrophy and the corresponding dissipations,</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="WavKinS.store_spectral!-Tuple{Union{Petviashvilli, Petviashvilli_Asymp}}" href="#WavKinS.store_spectral!-Tuple{Union{Petviashvilli, Petviashvilli_Asymp}}"><code>WavKinS.store_spectral!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">store_spectral(Run::Union{Petviashvilli_Asymp,Petviashvilli})</code></pre><p>Compute and store Petviashvilli_Asymp spectral quantities</p><ul><li><code>Run</code>: Petviashvilli<em>Asymp or Petviashvilli WavKinS simulation structure containing the wave action ``n</em>{\bf k}``</li></ul><p>This routine computes and store in <code>Run.diags.sp_store</code>  the waveaction, and the energy and waveaction flux spectra.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="MMT.html">« MMT</a><a class="docs-footer-nextpage" href="Smoluchowski.html">Smoluchowski »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 27 November 2024 11:37">Wednesday 27 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
